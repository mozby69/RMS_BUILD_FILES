(()=>{var a={};a.id=929,a.ids=[929],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7342:(a,b,c)=>{Promise.resolve().then(c.bind(c,34437))},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:a=>{"use strict";a.exports=require("assert")},13862:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>d});let d=(0,c(61369).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/app/app/request/submit-request/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/app/app/request/submit-request/page.tsx","default")},19121:a=>{"use strict";a.exports=require("next/dist/server/app-render/action-async-storage.external.js")},21820:a=>{"use strict";a.exports=require("os")},26713:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/is-bot")},27910:a=>{"use strict";a.exports=require("stream")},28354:a=>{"use strict";a.exports=require("util")},29021:a=>{"use strict";a.exports=require("fs")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:a=>{"use strict";a.exports=require("path")},34437:(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>a4});var d=c(60687),e=c(43210),f=c.n(e),g=c(29041),h=c(93074);let i=(0,h.A)((0,d.jsx)("path",{d:"M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9m-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8z"}),"Restore");var j=c(33294),k=c(81121),l=c(35283),m=c(27605),n=c(7418),o=c(63442),p=c(97062),q=c(94267),r=c(2369),s=c(42604),t=c(68540),u=c(96318);function v({requestType:a,formData:b,onClose:c,onReset:e,approvers:f}){let{data:h}=(0,k.XU)(),{data:i=[]}=(0,k.In)(),{mutate:j}=(0,k.Pm)(),l=h?.find(a=>a.id===b?.requestToId)??null,m=i.find(a=>a.id===b?.requestFromId);return(0,d.jsxs)("div",{className:"flex flex-col px-10 overflow-auto max-h-150",children:[(0,d.jsxs)("div",{className:"flex flex-col justify-center items-center font-extrabold text-xl",children:[(0,d.jsx)("h1",{children:m?.companyName??""}),(0,d.jsxs)("h1",{children:[m?.branchName??""," "]})]}),(0,d.jsxs)("div",{className:"flex flex-col border-t-3 border-b-3 mt-3 py-2 font-semibold",children:[(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsx)("p",{className:"w-20",children:"To"}),(0,d.jsx)("p",{children:":"}),(0,d.jsxs)("div",{className:"flex flex-col",children:[(0,d.jsx)("p",{children:l?.name??""}),(0,d.jsx)("p",{className:"text-center",children:l?.position??""})]})]}),(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsx)("p",{className:"w-20",children:"From"}),(0,d.jsx)("p",{children:":"}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)("p",{children:m?.branchName??""})})]}),(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsx)("p",{className:"w-20",children:"Report"}),(0,d.jsx)("p",{children:":"}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)("p",{children:a?.requestName})})]}),(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsx)("p",{className:"w-20",children:"Date"}),(0,d.jsx)("p",{children:":"}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)("p",{children:(0,d.jsx)(s.XU,{value:b?.requestDate})})})]})]}),(0,d.jsxs)("div",{className:"flex flex-col py-5 gap-3 font-semibold",children:[(0,d.jsx)("div",{className:"indent-8",children:(0,d.jsx)("p",{children:"Good Day!"})}),(0,d.jsx)("div",{className:"flex",children:(0,d.jsx)("p",{className:"indent-8",children:b?.requestContent})}),(0,d.jsx)("p",{className:"indent-8",children:"Your favorable response with this matter would be highly appreciated."}),(0,d.jsx)("p",{className:"indent-8",children:"Thank you very much & God Bless"})]}),(0,d.jsx)(u.A,{approverList:f}),(0,d.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,d.jsx)(p.A,{label:"Submit with e signature",onClick:()=>{j(b,{onSuccess:()=>{(0,t.Te)({message:"Request added successfully!",position:"top-center",duration:3e3}),e?.(),c?.()}})},variant:"success",icon:(0,d.jsx)(g.A,{})}),(0,d.jsx)(p.A,{label:"Close",variant:"danger",onClick:c,icon:(0,d.jsx)(r.A,{})})]})]})}var w=c(48622);function x(a){return(a.toUpperCase(),a.includes("EMB")||a.includes("PSPMI"))?7:8}function y(a,b){let c=a.find(a=>a.id===b);return console.log("bramcj ",c?.bfomId),c?.bfomId??null}let z=[{label:"Checked By",field:"checkedById"},{label:"Checked By 2",field:"checkedBy2Id"},{label:"Checked By 3",field:"checkedBy3Id"},{label:"Checked By 4",field:"checkedBy4Id"},{label:"Recom Approval",field:"recomApprovalId"},{label:"Recom Approval 2",field:"recomApproval2Id"},{label:"Approve",field:"approveById"},{label:"Final Approver",field:"approveBy2Id"}];function A({control:a,approverData:b,setValue:c,getValues:e}){let{data:f}=(0,w.rA)(),{data:g}=(0,k.In)();return(0,d.jsx)("div",{className:"grid grid-cols-12 gap-3 mt-4 w-full",children:z.map(c=>(0,d.jsx)("div",{className:"col-span-3",children:(0,d.jsx)(m.xI,{name:`approvers.${c.field}`,control:a,render:({field:a,fieldState:e})=>(0,d.jsx)(j.A,{data:b,label:c.label,placeholder:`Select ${c.label}`,name:a.name,value:a.value??void 0,onChange:b=>{2===b&&f?.branch?.coordinatorId?a.onChange(f.branch.coordinatorId):3===b&&f?.branch?a.onChange(x(f.branch.branchName)):4===b&&f?.branch?.id&&void 0!==g?a.onChange(y(g,f.branch.id)):a.onChange(b)},inputRef:a.ref,error:e.error})})},c.field))})}function B({requestTypeId:a,requestType:b}){let[c,f]=(0,e.useState)(null),[h,r]=(0,e.useState)(!1),[s,t]=(0,e.useState)(null),{data:u}=(0,k.XU)(),{data:z=[]}=(0,k.In)(),{data:B}=(0,w.rA)(),C=(u??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),D=z.map(a=>({id:a.id??"",name:a.branchName??""})),{control:E,register:F,handleSubmit:G,reset:H,setValue:I,getValues:J,formState:{errors:K}}=(0,m.mN)({resolver:(0,o.u)(n.Vm),defaultValues:{requestTypeId:a,requestFromId:B?.branch?.id??void 0,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}}),L=()=>{H()};return(0,d.jsxs)("div",{className:"bg-white border border-[#ECECEC] min-h-80 px-6 py-3 rounded-md",children:[(0,d.jsx)("div",{className:"p-1.5",children:(0,d.jsx)("h3",{className:"text-2xl font-extrabold text-gray-600 text-center",children:"Fund Transfer Request Form"})}),(0,d.jsxs)("form",{onSubmit:G(a=>{t(a.approvers);let b=B?.branch?.coordinatorId,c=[{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b};else if(4===a.id&&B?.branchId)return{...a,id:y(z,B?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&B?.branch?{...a,id:x(B?.branch?.branchName)}:a});f({...a,approvers:c}),r(!0)}),children:[(0,d.jsxs)("div",{className:"grid grid-cols-12 gap-3 items-center",children:[(0,d.jsx)("div",{className:"flex flex-row items-end col-span-5",children:(0,d.jsx)(m.xI,{name:"requestToId",control:E,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:C,label:"Request To",placeholder:"Select request to...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"flex flex-row items-end col-span-5",children:(0,d.jsx)(m.xI,{name:"requestFromId",control:E,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:D,label:"Request From",placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"flex flex-row items-end col-span-2",children:(0,d.jsx)(l.Pd,{label:"Date",placeholder:"Enter Date",register:F("requestDate",{valueAsDate:!0}),error:K.requestDate,type:"date"})}),(0,d.jsx)("div",{className:"col-span-12 h-64",children:(0,d.jsx)(l.sO,{label:"Request Content",placeholder:"Enter request content",register:F("requestContent"),error:K.requestContent})})]}),(0,d.jsx)(A,{control:E,approverData:C,setValue:I,getValues:J}),(0,d.jsxs)("div",{className:"flex justify-end gap-2 mt-3",children:[(0,d.jsx)(p.A,{label:"Submit",size:"md",type:"submit",icon:(0,d.jsx)(g.A,{})}),(0,d.jsx)(p.A,{label:"Reset",variant:"info",size:"md",type:"button",onClick:L,icon:(0,d.jsx)(i,{})})]})]}),h&&(0,d.jsx)(q.A,{size:"xl",children:(0,d.jsx)(v,{onClose:()=>{r(!1)},onReset:L,formData:c,requestType:b,approvers:s})})]})}var C=c(99756);let D=C.Ik({name:C.Yj().min(1,"Name is required"),position:C.Yj().min(1,"Position is required"),departure_date:C.Yj().min(1,"Departure date is required"),destination:C.Yj().min(1,"Destination is required"),current_date:C.Yj().min(1,"Current date is required"),purpose_of_travel:C.Yj().min(1,"Purpose is required"),report_to:C.Yj(),expenses_allowed:C.ai(),numCols:C.ai().min(0,"Number of columns cannot be negative").max(50,"Number of columns cannot exceed 50").optional(),headers:C.YO(C.Yj()).optional(),rows:C.YO(C.YO(C.Yj())).optional(),totalsEnabled:C.YO(C.zM()).optional(),columnTotals:C.YO(C.ai()).optional(),requestFromId:C.ai().min(1,"from is required"),requestTypeId:C.ai().optional(),createdAt:C.p6().optional(),updatedAt:C.p6().optional()}).omit({createdAt:!0,updatedAt:!0}).extend({approvers:n.XC}),E=C.Ik({item_description:C.Yj().min(1,"item description is required"),quantity:C.Yj().min(1,"quantity is required"),date_of_last_request:C.Yj(),allocation:C.Yj().min(1,"allocation is required"),remarks:C.Yj()}),F=C.Ik({inventory_description:C.Yj().min(1,"inventory description is required"),unit:C.Yj().min(1,"unit is required"),beginning:C.Yj(),ending:C.Yj(),utilized:C.Yj(),remarks:C.Yj(),checkbox:C.zM()}),G=C.Ik({request_description:C.Yj().min(1,"Name is required"),date:C.Yj().min(1,"Date is required"),from_name:C.Yj().min(1,"From is required"),items:C.YO(E).min(1,"At least one entry is required"),inventory_data:C.YO(F).min(1,"at least one entry is required"),requestFromId:C.ai().min(1,"From is required"),requestTypeId:C.ai().optional(),requestToId:C.ai({message:"Select only in the provided data"}).min(1,{message:"Requested to is required"}),createdAt:C.p6().optional(),updatedAt:C.p6().optional()}).omit({createdAt:!0,updatedAt:!0}).extend({approvers:n.XC}),H=C.Ik({item_description:C.Yj().min(1,"description is required"),budget:C.ai().optional(),total_expense:C.ai().optional(),variance:C.ai().optional(),proposed_budget:C.ai().optional(),remarks:C.Yj().optional()}),I=C.Ik({month_of:C.Yj().min(1,"Date is required"),requestFromId:C.ai().min(1,"From is required"),requestTypeId:C.ai().optional(),createdAt:C.p6().optional(),updatedAt:C.p6().optional(),admin_exp:C.YO(H),office_exp:C.YO(H),unbudgeted_exp:C.YO(H)}).omit({createdAt:!0,updatedAt:!0}).extend({approvers:n.XC}),J=C.Ik({date:C.Yj().min(1,"Date is required"),request_description:C.Yj().min(1,"description is required"),request_note:C.Yj(),numCols:C.ai().optional(),headers:C.YO(C.Yj()).optional(),rows:C.YO(C.YO(C.Yj())).optional(),requestFromId:C.ai().min(1,"From is required"),requestTypeId:C.ai().optional(),requestToId:C.ai({message:"Select only in the provided data"}).min(1,{message:"Requested to is required"}),createdAt:C.p6().optional(),updatedAt:C.p6().optional()}).omit({createdAt:!0,updatedAt:!0}).extend({approvers:n.XC}),K=C.Ik({date_endorsed:C.Yj(),id_no:C.Yj().min(1,"id number is required"),name_of_pensioner:C.Yj().min(1,"name of pensioner is required"),bank:C.Yj(),type_of_pension:C.Yj(),age:C.Yj(),date_in:C.Yj(),first_coll_effect:C.Yj(),last_transaction:C.Yj(),transaction_type:C.Yj(),no_of_months_overdue:C.Yj(),with_insurance_icod:C.Yj(),reason_for_no_insurance:C.Yj(),loan_balance_as_of:C.Yj(),total_lr:C.ai(),total_ap:C.ai(),total_udi:C.ai(),total_ide:C.ai(),reason_for_non_coll_acc:C.Yj(),co_maker:C.Yj(),relation_to_ssp:C.Yj(),contact_number:C.Yj(),compromise_payment:C.Yj(),payment_start:C.Yj(),action_taken:C.Yj(),requestFromId:C.ai().min(1,"From is required"),requestTypeId:C.ai().optional(),createdAt:C.p6().optional(),updatedAt:C.p6().optional()}).omit({createdAt:!0,updatedAt:!0}).extend({approvers:n.XC}),L=C.Ik({item_name:C.Yj().min(1,"item is required")}),M=C.Ik({date:C.Yj().min(1,"Date is required"),request_description:C.Yj().min(1,"description is required"),request_note:C.Yj(),items_list:C.YO(L).min(1,"At least one entry is required"),requestFromId:C.ai().min(1,"From is required"),requestTypeId:C.ai().optional(),requestToId:C.ai({message:"Select only in the provided data"}).min(1,{message:"Requested to is required"}),createdAt:C.p6().optional(),updatedAt:C.p6().optional()}).omit({createdAt:!0,updatedAt:!0}).extend({approvers:n.XC}),N=C.Ik({destination_name:C.Yj().min(1,"destination is required")}),O=C.Ik({date:C.Yj(),day:C.Yj(),from:C.Yj(),to:C.Yj(),transportation_services:C.Yj(),or_number:C.Yj(),amount:C.ai()}),P=C.Ik({computation_date:C.Yj(),branch_name:C.Yj(),beg:C.ai(),ending:C.ai(),kilometers_consume:C.ai(),consumption_km:C.ai(),gas_liter_consume:C.ai(),gas_price_per_liter:C.ai()}),Q=C.Ik({branch_name:C.Yj(),transpo:C.ai(),fuel:C.ai(),meals:C.ai(),accomodation:C.ai(),total:C.ai().optional()}),R=C.Ik({name:C.Yj().min(1,"name is required"),trip_ticket_number:C.Yj().min(1,"trip ticket is required"),approved_budget:C.ai().min(1,"budget is required"),computation_date_from:C.Yj(),computation_date_to:C.Yj(),destination_list:C.YO(N).min(1,"At least one entry is required"),travel_details_list:C.YO(O).min(1,"at least one entry is required"),computation_list:C.YO(P).min(1,"at least one entry is required"),breakdown_expenses_list:C.YO(Q),requestFromId:C.ai().min(1,"From is required"),requestTypeId:C.ai().optional(),createdAt:C.p6().optional(),updatedAt:C.p6().optional()}).omit({createdAt:!0,updatedAt:!0}).extend({approvers:n.XC}),S=C.Ik({date:C.Yj(),approved_weekly_itinerary:C.Yj(),purpose:C.Yj(),deviation:C.Yj()}),T=C.Ik({cur_date:C.Yj().min(1,"Date is required"),table_data:C.YO(S).min(1,"At least one entry is required"),requestFromId:C.ai().min(1,"From is required"),requestTypeId:C.ai().optional(),createdAt:C.p6().optional(),updatedAt:C.p6().optional()}).omit({createdAt:!0,updatedAt:!0}).extend({approvers:n.XC}),U=C.Ik({date:C.Yj(),days:C.Yj(),branch:C.Yj(),remarks:C.Yj()}),V=C.Ik({from_date:C.Yj().min(1,"Date is required"),to_date:C.Yj().min(1,"date is required"),table_data:C.YO(U).min(1,"At least one entry is required"),requestFromId:C.ai().min(1,"From is required"),requestTypeId:C.ai().optional(),createdAt:C.p6().optional(),updatedAt:C.p6().optional()}).omit({createdAt:!0,updatedAt:!0}).extend({approvers:n.XC}),W=C.Ik({date:C.Yj(),particulars:C.Yj(),amount:C.ai()}),X=C.Ik({name:C.Yj().min(1,"name is required"),date_covered:C.Yj().min(1,"date is required"),purpose:C.Yj().min(1,"purpose is required"),table_data:C.YO(W).min(1,"At least one entry is required"),requestFromId:C.ai().min(1,"From is required"),requestTypeId:C.ai().optional(),createdAt:C.p6().optional(),updatedAt:C.p6().optional()}).omit({createdAt:!0,updatedAt:!0}).extend({approvers:n.XC}),Y=C.Ik({name:C.Yj().optional(),address:C.Yj().optional(),prices:C.YO(C.ai().optional())}),Z=C.Ik({item_name:C.Yj().min(1,"Item name is required"),qty:C.ai().min(1,"Quantity is required"),unit_of_quantity:C.Yj().min(1,"Unit is required"),po_unit_cost:C.ai().optional(),remarks:C.Yj().optional()}),$=C.Ik({date:C.Yj().min(1,"Date is required"),document_number:C.Yj(),items_list:C.YO(Z).min(1,"At least one item is required"),supplier_list:C.YO(Y).length(3),requestFromId:C.ai().min(1,"From is required"),requestTypeId:C.ai().optional(),createdAt:C.p6().optional(),updatedAt:C.p6().optional()}).omit({createdAt:!0,updatedAt:!0}).extend({approvers:n.XC}),_=C.Ik({supplier_name:C.Yj().min(1,"Supplier name is required"),supplier_address:C.Yj()}),aa=C.Ik({unit_of_qty:C.Yj(),qty:C.ai().min(1,"Quantity is required"),item_name:C.Yj().min(1,"item name is required"),unit_price:C.ai().min(1,"unit price is required"),supplier_name:C.Yj(),supplier_address:C.Yj(),remarks:C.Yj()}),ab=C.Ik({date:C.Yj().min(1,"Date is required"),document_number:C.Yj(),items_list:C.YO(aa).min(1,"At least one item is required"),requestFromId:C.ai().min(1,"From is required"),requestTypeId:C.ai().optional(),createdAt:C.p6().optional(),updatedAt:C.p6().optional()}).omit({createdAt:!0,updatedAt:!0}).extend({approvers:n.XC});var ac=c(26668);function ad({requestTypeId:a,requestType:b}){let{data:c}=(0,w.rA)(),{data:f=[]}=(0,k.In)(),{data:h}=(0,k.XU)(),[i,n]=(0,e.useState)(null),[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(null),[v,z]=(0,e.useState)(0),[B,C]=(0,e.useState)([]),[E,F]=(0,e.useState)([]),[G,H]=(0,e.useState)([]),I=(h??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),J=f.map(a=>({id:a.id??"",name:a.branchName??""})),{control:K,register:L,handleSubmit:M,reset:N,setValue:O,getValues:P,formState:{errors:Q}}=(0,m.mN)({resolver:(0,o.u)(D),defaultValues:{requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}});return(0,d.jsxs)("div",{className:"bg-white border border-[#ECECEC] min-h-70 px-3 py-8 rounded-md",children:[(0,d.jsx)("div",{className:"p-1.5",children:(0,d.jsxs)("h3",{className:"text-2xl font-extrabold text-gray-600 text-center",children:[b?.requestName??""," FORM"]})}),(0,d.jsxs)("form",{className:"grid grid-cols-[repeat(auto-fit,minmax(300px,1fr))] gap-4 px-4 mt-8",onSubmit:M(a=>{u(a.approvers);let b=c?.branch?.coordinatorId,d=[{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b};else if(4===a.id&&c?.branchId)return{...a,id:y(f,c?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&c?.branch?{...a,id:x(c?.branch?.branchName)}:a});console.log("approval1: ",d),n({...a,table_data:{headers:B,rows:E},approvers:d}),s(!0)}),children:[(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Name",placeholder:"Enter Date...",register:L("name"),error:Q.name,type:"text"})}),(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestFromId",control:K,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:J,label:"Branch",placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Position",placeholder:"Enter Position...",register:L("position"),error:Q.position,type:"text"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Departure Date",placeholder:"Enter departure date...",register:L("departure_date"),error:Q.departure_date,type:"date"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Destination",placeholder:"Enter destination...",register:L("destination"),error:Q.destination,type:"text"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Current Date",placeholder:"Enter current date...",register:L("current_date"),error:Q.current_date,type:"date"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Purpose of Travel",placeholder:"Enter purpose of travel...",register:L("purpose_of_travel"),error:Q.purpose_of_travel,type:"text"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Report To",placeholder:"Enter Report to...",register:L("report_to"),error:Q.report_to,type:"text"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Expenses Allowed",placeholder:"Enter expenses allowed...",register:L("expenses_allowed",{valueAsNumber:!0}),error:Q.expenses_allowed,type:"number"})}),(0,d.jsx)("div",{className:"flex flex-col col-span-full w-4/12",children:(0,d.jsx)(l.Pd,{label:"Number of columns",register:L("numCols",{valueAsNumber:!0,onChange:a=>{let b=Number(a.target.value);if(isNaN(b)||b<0){z(0),C([]),F([]),H([]);return}if(b>50){alert("⚠️ Maximum of 50 columns allowed."),z(50),C(Array(50).fill("")),F([Array(50).fill("")]),H(Array(50).fill(!1));return}b>0?(z(b),C(Array(b).fill("")),F([Array(b).fill("")]),H(Array(b).fill(!1))):(z(0),C([]),F([]),H([]))}}),placeholder:"Enter a number...",type:"number"})}),v>0&&(0,d.jsxs)("div",{className:"p-4 col-span-full",children:[(0,d.jsx)("h3",{className:"font-semibold mb-2",children:"DEFINE COLUMN HEADERS"}),(0,d.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(10rem,1fr))] gap-2",children:[B.map((a,b)=>(0,d.jsx)("input",{type:"text",placeholder:`Column ${b+1}`,value:a,onChange:a=>{var c;return c=a.target.value,void C(a=>{let d=a.map((a,d)=>d===b?c:a);return O("headers",d),d})},className:"border border-gray-300 bg-gray-50 rounded-lg p-2"},b)),Q.numCols&&(0,d.jsx)("p",{className:"text-sm text-red-500",children:Q.numCols.message})]})]}),(0,d.jsx)("div",{className:"col-span-full",children:E.length>0&&(0,d.jsx)("div",{className:"overflow-x-auto p-4",children:(0,d.jsxs)("table",{className:"w-full border border-gray-300",children:[(0,d.jsx)("thead",{children:(0,d.jsx)("tr",{children:B.map((a,b)=>(0,d.jsx)("th",{className:"border border-gray-300 p-2 bg-gray-100 text-sm",children:a||`Column ${b+1}`},b))})}),(0,d.jsxs)("tbody",{children:[E.map((a,b)=>(0,d.jsxs)("tr",{children:[a.map((a,c)=>(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)("input",{type:"text",value:a,onChange:a=>{var d;return d=a.target.value,void F(a=>{let e=a.map((a,e)=>e===b?a.map((a,b)=>b===c?d:a):a);if(0===c&&b===a.length-1&&""!==d.trim()){let a=[...e,Array(v).fill("")];return O("rows",a),a}return O("rows",e),e})},className:"w-full border border-gray-300 rounded p-1"})},c)),(0,d.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:E.length>1&&(0,d.jsx)("button",{type:"button",onClick:()=>{F(a=>a.filter((a,c)=>c!==b))},className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-md",children:"\uD83D\uDDD1"})})]},b)),(0,d.jsxs)("tr",{children:[B.map((a,b)=>(0,d.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:(0,d.jsxs)("label",{className:"flex items-center justify-center gap-1 text-xs",children:[(0,d.jsx)("input",{type:"checkbox",checked:G[b]||!1,onChange:a=>{let c=[...G];c[b]=a.target.checked,H(c),O("totalsEnabled",c)}}),"Total"]})},b)),(0,d.jsx)("td",{className:"border border-gray-300 p-2"})]})]})]})})}),(0,d.jsx)("div",{className:"col-span-full mt-10",children:(0,d.jsx)(A,{control:K,approverData:I,setValue:O,getValues:P})}),(0,d.jsx)("div",{className:"col-span-full justify-end flex gap-2",children:(0,d.jsx)(p.A,{label:"Preview",size:"md",type:"submit",icon:(0,d.jsx)(g.A,{})})})]}),r&&(0,d.jsx)(q.A,{title:"TravelOrder Summary",size:"xl",children:(0,d.jsx)(ac.A,{onClose:()=>{s(!1)},onReset:()=>{N(),z(0),C([]),F([]),H([])},formData:{...i,headers:B,rows:E},requestType:b,approvers:t})})]})}var ae=c(4663);function af({requestTypeId:a,requestType:b}){let[c,f]=(0,e.useState)(null),[h,i]=(0,e.useState)(!1),[n,r]=(0,e.useState)(null),{data:s}=(0,w.rA)(),{data:t}=(0,k.XU)(),{data:u=[]}=(0,k.In)(),v=(t??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),z=u.map(a=>({id:a.id??"",name:a.branchName??""})),{control:B,register:C,handleSubmit:D,reset:E,setValue:F,getValues:G,formState:{errors:H}}=(0,m.mN)({resolver:(0,o.u)(I),defaultValues:{requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}}),{fields:J,append:K,remove:L}=(0,m.jz)({control:B,name:"admin_exp"}),{fields:M,append:N,remove:O}=(0,m.jz)({control:B,name:"office_exp"}),{fields:P,append:Q,remove:R}=(0,m.jz)({control:B,name:"unbudgeted_exp"});return(0,d.jsxs)("div",{className:"bg-white border border-[#ECECEC] min-h-80 px-6 py-3 rounded-md",children:[(0,d.jsx)("div",{children:(0,d.jsx)("h2",{className:"p-4 font-extrabold text-2xl text-center text-gray-700",children:"PROPOSED BUDGET"})}),(0,d.jsx)("form",{onSubmit:D(a=>{r(a.approvers);let b=s?.branch?.coordinatorId,c=[{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b};else if(4===a.id&&s?.branchId)return{...a,id:y(u,s?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&s?.branch?{...a,id:x(s?.branch?.branchName)}:a});f({...a,approvers:c}),i(!0)}),children:(0,d.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(20rem,1fr))] gap-4 p-4 mt-8",children:[(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestFromId",control:B,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:z,label:"Branch",placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Month Of",placeholder:"Enter Date...",register:C("month_of"),error:H.month_of,type:"month"})}),(0,d.jsxs)("div",{className:"col-span-full mt-4",children:[(0,d.jsx)("h2",{className:"font-bold text-gray-700 mb-2",children:"ADMIN & PERSONNEL EXPENSES:"}),(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Item Description"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Budget"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Total Expense"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Variance"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Proposed Budget"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Remarks"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Action"})]})}),(0,d.jsx)("tbody",{children:J.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Description",register:C(`admin_exp.${b}.item_description`),error:H.admin_exp?.[b]?.item_description})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"Budget",register:C(`admin_exp.${b}.budget`,{valueAsNumber:!0,onChange:a=>{let c=Number(a.target.value)||0,d=G(`admin_exp.${b}.total_expense`)||0;F(`admin_exp.${b}.variance`,c-d)}}),error:H.admin_exp?.[b]?.budget})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"Total Expense",register:C(`admin_exp.${b}.total_expense`,{valueAsNumber:!0,onChange:a=>{let c=Number(a.target.value)||0,d=G(`admin_exp.${b}.budget`)||0;F(`admin_exp.${b}.variance`,d-c)}}),error:H.admin_exp?.[b]?.total_expense})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"Variance",register:C(`admin_exp.${b}.variance`,{valueAsNumber:!0}),error:H.admin_exp?.[b]?.variance})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"Proposed Budget",register:C(`admin_exp.${b}.proposed_budget`,{valueAsNumber:!0}),error:H.admin_exp?.[b]?.proposed_budget})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Remarks",register:C(`admin_exp.${b}.remarks`),error:H.admin_exp?.[b]?.remarks})}),(0,d.jsx)("td",{className:"border border-gray-300",children:(0,d.jsx)("button",{disabled:1===J.length,type:"button",onClick:()=>L(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},a.id))})]}),(0,d.jsx)("button",{type:"button",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 mt-4",onClick:()=>K({item_description:"",budget:0,total_expense:0,variance:0,proposed_budget:0,remarks:""}),children:"✚ Add Admin EXP"})]}),(0,d.jsxs)("div",{className:"col-span-full mt-4",children:[(0,d.jsx)("h2",{className:"font-bold text-gray-700 mb-2",children:"OFFICE & OTHER EXPENSES:"}),(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Item Description"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Budget"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Total Expense"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Variance"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Proposed Budget"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Remarks"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Action"})]})}),(0,d.jsx)("tbody",{children:M.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Description",register:C(`office_exp.${b}.item_description`),error:H.office_exp?.[b]?.item_description})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"Budget",register:C(`office_exp.${b}.budget`,{valueAsNumber:!0,onChange:a=>{let c=Number(a.target.value)||0,d=G(`office_exp.${b}.total_expense`)||0;F(`office_exp.${b}.variance`,c-d)}}),error:H.office_exp?.[b]?.budget})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"Total Expense",register:C(`office_exp.${b}.total_expense`,{valueAsNumber:!0,onChange:a=>{let c=Number(a.target.value)||0,d=G(`office_exp.${b}.budget`)||0;F(`office_exp.${b}.variance`,d-c)}}),error:H.office_exp?.[b]?.total_expense})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"Variance",register:C(`office_exp.${b}.variance`,{valueAsNumber:!0}),error:H.office_exp?.[b]?.variance})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"Proposed Budget",register:C(`office_exp.${b}.proposed_budget`,{valueAsNumber:!0}),error:H.office_exp?.[b]?.proposed_budget})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Remarks",register:C(`office_exp.${b}.remarks`),error:H.office_exp?.[b]?.remarks})}),(0,d.jsx)("td",{className:"border border-gray-300",children:(0,d.jsx)("button",{type:"button",disabled:1===M.length,onClick:()=>O(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},a.id))})]}),(0,d.jsx)("button",{type:"button",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 mt-4",onClick:()=>N({item_description:"",budget:0,total_expense:0,variance:0,proposed_budget:0,remarks:""}),children:"✚ Add Office EXP"})]}),(0,d.jsxs)("div",{className:"col-span-full mt-4",children:[(0,d.jsx)("h2",{className:"font-bold text-gray-700 mb-2",children:"UNBUDGETED EXPENSES:"}),(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Item Description"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Budget"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Total Expense"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Variance"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Proposed Budget"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Remarks"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Action"})]})}),(0,d.jsx)("tbody",{children:P.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Description",register:C(`unbudgeted_exp.${b}.item_description`),error:H.unbudgeted_exp?.[b]?.item_description})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"Budget",register:C(`unbudgeted_exp.${b}.budget`,{valueAsNumber:!0}),error:H.unbudgeted_exp?.[b]?.budget})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"Total Expense",register:C(`unbudgeted_exp.${b}.total_expense`,{valueAsNumber:!0}),error:H.unbudgeted_exp?.[b]?.total_expense})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"Variance",register:C(`unbudgeted_exp.${b}.variance`,{valueAsNumber:!0}),error:H.unbudgeted_exp?.[b]?.variance})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"Proposed Budget",register:C(`unbudgeted_exp.${b}.proposed_budget`,{valueAsNumber:!0}),error:H.unbudgeted_exp?.[b]?.proposed_budget})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Remarks",register:C(`unbudgeted_exp.${b}.remarks`),error:H.unbudgeted_exp?.[b]?.remarks})}),(0,d.jsx)("td",{className:"border border-gray-300",children:(0,d.jsx)("button",{disabled:1===P.length,type:"button",onClick:()=>R(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},a.id))})]}),(0,d.jsx)("button",{type:"button",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 mt-4",onClick:()=>Q({item_description:"",budget:0,total_expense:0,variance:0,proposed_budget:0,remarks:""}),children:"✚ Add Office EXP"})]}),(0,d.jsx)("div",{className:"col-span-full mt-10",children:(0,d.jsx)(A,{control:B,approverData:v,setValue:F,getValues:G})}),(0,d.jsx)("div",{className:"col-span-full flex justify-end mt-3",children:(0,d.jsx)(p.A,{label:"Submit",size:"md",type:"submit",icon:(0,d.jsx)(g.A,{})})})]})}),h&&(0,d.jsx)(q.A,{size:"xl",children:(0,d.jsx)(ae.A,{onClose:()=>{i(!1)},onReset:()=>{E()},formData:c,requestType:b,approvers:n})})]})}var ag=c(73821);function ah({requestTypeId:a,requestType:b}){let[c,f]=(0,e.useState)(!1),[h,i]=(0,e.useState)(null),{data:n}=(0,w.rA)(),{data:r=[]}=(0,k.In)(),{data:s}=(0,k.XU)(),[t,u]=(0,e.useState)(null),v=(s??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),z=r.map(a=>({id:a.id??"",name:a.branchName??""})),{control:B,register:C,handleSubmit:D,reset:E,setValue:F,getValues:G,formState:{errors:H}}=(0,m.mN)({resolver:(0,o.u)(M),defaultValues:{requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}}),{fields:I,append:J,remove:K}=(0,m.jz)({control:B,name:"items_list"});return(0,d.jsxs)("div",{className:"bg-white border border-[#ECECEC] min-h-90 py-4 px-3 rounded-md",children:[(0,d.jsx)("div",{className:"text-center",children:(0,d.jsx)("h2",{className:"p-4 font-extrabold text-2xl text-gray-600",children:"TRANSMITTAL MEMO"})}),(0,d.jsx)("form",{onSubmit:D(a=>{u(a.approvers);let b=n?.branch?.coordinatorId,c=[{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b};else if(4===a.id&&n?.branchId)return{...a,id:y(r,n?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&n?.branch?{...a,id:x(n?.branch?.branchName)}:a});i({...a,approvers:c}),f(!0)}),children:(0,d.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(25rem,1fr))] gap-4 p-4 mt-8",children:[(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestToId",control:B,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:v,label:"Request To",placeholder:"Select request to...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestFromId",control:B,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:z,label:"Branch",placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Date",register:C("date"),error:H.date,type:"date"})}),(0,d.jsx)("div",{className:"flex col-span-2",children:(0,d.jsx)(l.sO,{label:"Request Description",register:C("request_description"),error:H.request_description})}),(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(l.sO,{label:"Note",register:C("request_note"),error:H.request_note})}),(0,d.jsxs)("div",{className:"col-span-full mt-4",children:[(0,d.jsx)("h2",{className:"font-bold text-gray-700 mb-2",children:"ITEM LIST:"}),(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Item Name"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400 w-1/12",children:"Action"})]})}),(0,d.jsx)("tbody",{children:I.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Description",register:C(`items_list.${b}.item_name`),error:H.items_list?.[b]?.item_name})}),(0,d.jsx)("td",{className:"border border-gray-300 w-1/12",children:(0,d.jsx)("button",{disabled:1===I.length,type:"button",onClick:()=>K(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},a.id))})]}),(0,d.jsx)("button",{type:"button",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 mt-4",onClick:()=>J({item_name:""}),children:"✚ Add Admin EXP"})]}),(0,d.jsx)("div",{className:"col-span-full mt-15 border-t border-gray-300 pt-4",children:(0,d.jsx)(A,{control:B,approverData:v,setValue:F,getValues:G})}),(0,d.jsx)("div",{className:"col-span-full flex justify-end mt-3",children:(0,d.jsx)(p.A,{label:"Submit",size:"md",type:"submit",icon:(0,d.jsx)(g.A,{})})})]})}),c&&(0,d.jsx)(q.A,{size:"lg",children:(0,d.jsx)(ag.A,{onClose:()=>{f(!1)},onReset:()=>{E()},formData:h,requestType:b,approvers:t})})]})}let ai=(0,h.A)((0,d.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.89-2-2-2m0 16H5V7h14zm-5.5-6c0 .83-.67 1.5-1.5 1.5s-1.5-.67-1.5-1.5.67-1.5 1.5-1.5 1.5.67 1.5 1.5M12 9c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5"}),"Preview");var aj=c(39117);let ak=({tags:a,setTags:b,placeholder:c="Type and press Enter",onBlur:f})=>{let[g,h]=(0,e.useState)("");return(0,d.jsx)("div",{className:"flex flex-col gap-3",children:(0,d.jsxs)("div",{className:"border border-gray-300 rounded p-1.5 flex flex-wrap gap-2 min-h-[40px]",children:[a.map((c,e)=>(0,d.jsxs)("div",{className:"flex items-center bg-green-200 text-green-700 px-3 py-1 rounded-full text-sm",children:[c,(0,d.jsx)("button",{type:"button",onClick:()=>{b(a.filter((a,b)=>b!==e))},className:"ml-2 text-green-500 hover:text-green-700 focus:outline-none",children:"\xd7"})]},e)),(0,d.jsx)("input",{type:"text",className:"flex-grow outline-none p-1 text-sm",value:g,onChange:a=>h(a.target.value),onKeyDown:c=>{("Enter"===c.key||","===c.key)&&""!==g.trim()&&(c.preventDefault(),(()=>{let c=g.trim();c&&!a.includes(c)&&b([...a,c]),h("")})())},placeholder:c,onBlur:f})]})})},al=function(a){let{label:b="",name:c,register:e,error:f,type:g="text",options:h=[],className:i="",control:j,...k}=a,l=e(c);return(0,d.jsxs)("div",{className:"flex flex-col gap-2 flex-1",children:[(0,d.jsx)("label",{className:"font-semibold text-[#333333]",htmlFor:String(c),children:b}),"taginput"===g?(0,d.jsx)(m.xI,{name:c,control:j,render:({field:a})=>(0,d.jsx)(ak,{tags:a.value??[],setTags:b=>a.onChange(b),placeholder:k.placeholder||"Type and press Enter",onBlur:a.onBlur})}):"textarea"===g?(0,d.jsx)("textarea",{id:String(c),...l,className:`border border-gray-300 rounded p-2 flex flex-wrap gap-2 min-h-[42px] ${i}`,...k}):"select"===g?(0,d.jsxs)("select",{id:String(c),...l,className:`border border-gray-300 rounded p-2 flex flex-wrap gap-2 min-h-[42px] ${i}`,...k,children:[(0,d.jsx)("option",{value:"",children:"Select an option"}),h.map(a=>(0,d.jsx)("option",{value:a.value,children:a.label},a.value))]}):(0,d.jsx)("input",{id:String(c),type:g,...l,className:`border border-gray-300 rounded p-2 flex flex-wrap w-full gap-2 min-h-[42px] ${i}`,...k}),f&&(0,d.jsx)("p",{className:"text-red-400 font-light",children:"message"in f?f.message:Array.isArray(f)?f[0]?.message:void 0})]})};var am=c(3297);let an=({onChange:a,onDataChange:b,resetSignal:c})=>{let{register:e,handleSubmit:g,formState:{errors:h},reset:i,control:j,setValue:k,watch:l}=(0,m.mN)({resolver:(0,o.u)(n.EW),defaultValues:{tagsField:[],repairs:[]}}),[q,r]=f().useState([]),s=a=>({tagsField:a.tagsField??[],startDate:a.startDate?new Date(a.startDate).toISOString().slice(0,10):null,endDate:a.endDate?new Date(a.endDate).toISOString().slice(0,10):null,travelDate:a.travelDate?new Date(a.travelDate).toISOString().slice(0,10):null,travelling:a.travelling??null,fuelFee:"number"==typeof a.fuelFee?a.fuelFee:null,repairs:a.repairs&&a.repairs.length?a.repairs:null,litigationExp:"number"==typeof a.litigationExp?a.litigationExp:null,totalFunds:"number"==typeof a.totalFunds?a.totalFunds:null,travelKm:a.travelKm??null,fundRemarks:a.fundRemarks??null}),t=f().useCallback(a=>{r(b=>[...b,a]),i({tagsField:a.tagsField,repairs:[],travelDate:void 0,travelling:"",fuelFee:void 0,litigationExp:void 0,totalFunds:void 0,travelKm:"",fundRemarks:"",startDate:void 0,endDate:void 0})},[i]),u=a=>{console.log("Validation errors:",a)},v=f().useCallback(()=>{g(t,u)()},[g,t]),w=f().useMemo(()=>q.reduce((a,b)=>(a.fuel+=Number(b.fuelFee??0),a.total+=Number(b.totalFunds??0),a),{fuel:0,total:0}),[q]),x=a=>a.toFixed(2),y=l("fuelFee"),z=l("litigationExp");return f().useEffect(()=>{k("totalFunds",Number(y||0)+Number(z||0))},[y,z,k]),f().useEffect(()=>{a(w.total)},[w.total,a]),f().useEffect(()=>{b&&b(q.map(s))},[q,b]),f().useEffect(()=>{r([])},[c]),(0,d.jsxs)("div",{className:"main-body flex flex-col gap-6 bg-white px-8 py-6 rounded-md",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-y-3 gap-x-6",children:[(0,d.jsx)("div",{className:"py-2 col-span-2",children:(0,d.jsx)("h6",{className:"font-medium text-gray-500",children:"Period Covered"})}),(0,d.jsx)(al,{label:"Enter start date",type:"date",name:"startDate",register:e,error:h.startDate}),(0,d.jsx)(al,{label:"Enter end date",type:"date",name:"endDate",register:e,error:h.endDate}),(0,d.jsx)("div",{className:"py-2 col-span-2",children:(0,d.jsx)("h6",{className:"font-medium text-gray-500",children:"Fund Details"})}),(0,d.jsx)(al,{type:"taginput",name:"tagsField",label:"Marketing Officers",control:j,register:e,error:h.tagsField}),(0,d.jsx)(al,{className:"flex-1",label:"Travel Date",type:"date",name:"travelDate",register:e,error:h.travelDate}),(0,d.jsx)(al,{label:"Travelling",type:"text",name:"travelling",register:e,error:h.travelling}),(0,d.jsx)(al,{label:"Fuel Fees",type:"number",name:"fuelFee",register:e,error:h.fuelFee}),(0,d.jsx)(al,{label:"Repairs",type:"taginput",name:"repairs",control:j,register:e,error:h.repairs}),(0,d.jsx)(al,{label:"Litigation Expenses",type:"number",name:"litigationExp",register:e,error:h.litigationExp}),(0,d.jsx)(al,{label:"Total Fees",type:"number",name:"totalFunds",register:e,error:h.totalFunds,disabled:!0}),(0,d.jsx)(al,{label:"Kilometers",type:"text",name:"travelKm",register:e,error:h.travelKm}),(0,d.jsx)("div",{className:"col-span-2",children:(0,d.jsx)(al,{label:"Remarks",type:"textarea",name:"fundRemarks",register:e,error:h.fundRemarks})})]}),(0,d.jsx)("div",{className:"flex flex-row justify-end gap-2 ",children:(0,d.jsx)(p.A,{label:"Add Travel Funds",size:"sm",icon:(0,d.jsx)(am.A,{}),type:"button",variant:"success",onClick:v})})]}),(0,d.jsxs)("section",{className:"addded-section",children:[(0,d.jsx)("div",{className:"header py-1",children:(0,d.jsx)("h4",{className:"font-semibold text-[#333333]",children:"Added Travel Fund"})}),(0,d.jsxs)("table",{className:"added-list w-full border border-gray-300",children:[(0,d.jsx)("thead",{className:"bg-green-800 text-white",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Date"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Travelling"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Fuel"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Repairs"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Litigation"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Total"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Km"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Remarks"})]})}),(0,d.jsx)("tbody",{children:0===q.length?(0,d.jsx)("tr",{className:"bg-gray-100",children:(0,d.jsx)("td",{colSpan:8,className:"text-center p-2",children:"No records added yet."})}):q.map((a,b)=>(0,d.jsxs)("tr",{className:"bg-gray-100",children:[(0,d.jsx)("td",{className:"p-2 text-center",children:a.travelDate?new Date(a.travelDate).toLocaleDateString():"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:a.travelling??"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:"number"==typeof a.fuelFee?x(a.fuelFee):"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:Array.isArray(a.repairs)?a.repairs.join(", "):a.repairs??"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:"number"==typeof a.litigationExp?x(a.litigationExp):"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:"number"==typeof a.totalFunds?x(a.totalFunds):"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:a.travelKm??"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:a.fundRemarks??"-"})]},b))}),(0,d.jsx)("tfoot",{children:(0,d.jsxs)("tr",{className:"bg-gray-50 font-semibold",children:[(0,d.jsx)("td",{className:"p-2 text-right",children:"Total"}),(0,d.jsx)("td",{className:"p-2"}),(0,d.jsx)("td",{className:"p-2",children:x(w.fuel)}),(0,d.jsx)("td",{className:"p-2"}),(0,d.jsx)("td",{className:"p-2"}),(0,d.jsx)("td",{className:"p-2",children:x(w.total)}),(0,d.jsx)("td",{className:"p-2"}),(0,d.jsx)("td",{className:"p-2"})]})})]})]})]})},ao=({onChange:a,onDataChange:b,resetSignal:c})=>{let{register:e,handleSubmit:g,formState:{errors:h},reset:i,setValue:j,watch:k}=(0,m.mN)({resolver:(0,o.u)(n.JJ),defaultValues:{}}),[l,q]=f().useState([]),r=a=>({startDate:a.startDate?new Date(a.startDate).toISOString().slice(0,10):null,endDate:a.endDate?new Date(a.endDate).toISOString().slice(0,10):null,funDate:a.funDate?new Date(a.funDate).toISOString().slice(0,10):null,payee:a.payee??null,fundRemarks:a.fundRemarks??null,fundAmount:"number"==typeof a.fundAmount?a.fundAmount:null,miscExp:"number"==typeof a.miscExp?a.miscExp:null,powerLight:"number"==typeof a.powerLight?a.powerLight:null,telephone:"number"==typeof a.telephone?a.telephone:null,dueToMh:"number"==typeof a.dueToMh?a.dueToMh:null}),s=f().useCallback(a=>{q(b=>[...b,a]),i({funDate:void 0,payee:"",fundAmount:void 0,miscExp:void 0,powerLight:void 0,telephone:void 0,dueToMh:void 0,fundRemarks:"",startDate:void 0,endDate:void 0})},[i]),t=a=>{console.log("Validation errors:",a)},u=f().useCallback(()=>{g(s,t)()},[g,s]),v=f().useMemo(()=>l.reduce((a,b)=>(a.fundTotal+=Number(b.fundAmount??0),a.miscTotal+=Number(b.miscExp??0),a.powerTotal+=Number(b.powerLight??0),a.teleTotal+=Number(b.telephone??0),a.dueTotal+=Number(b.dueToMh??0),a),{fundTotal:0,miscTotal:0,powerTotal:0,teleTotal:0,dueTotal:0}),[l]),w=a=>a.toFixed(2),x=v.miscTotal+v.powerTotal+v.teleTotal+v.dueTotal;f().useEffect(()=>{a(x)},[x,a]),f().useEffect(()=>{b&&b(l.map(r))},[l,b]);let y=k("miscExp"),z=k("powerLight"),A=k("telephone"),B=k("dueToMh");return f().useEffect(()=>{j("fundAmount",Number(y||0)+Number(z||0)+Number(A||0)+Number(B||0))},[y,z,A,B,j]),f().useEffect(()=>{q([])},[c]),(0,d.jsxs)("div",{className:"main-body flex flex-col gap-6 bg-white px-8 py-6 rounded-md",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,d.jsxs)("div",{className:"grid grid-cols-2 gap-y-3 gap-x-6",children:[(0,d.jsx)("div",{className:"py-2 col-span-2",children:(0,d.jsx)("h6",{className:"font-medium text-gray-500",children:"Period Covered"})}),(0,d.jsx)(al,{label:"Enter start date",type:"date",name:"startDate",register:e,error:h.startDate}),(0,d.jsx)(al,{label:"Enter end date",type:"date",name:"endDate",register:e,error:h.endDate}),(0,d.jsx)("div",{className:"py-2 col-span-2",children:(0,d.jsx)("h6",{className:"font-medium text-gray-500",children:"Fund Details"})}),(0,d.jsx)(al,{className:"flex-1",label:"Cash Date",type:"date",name:"funDate",register:e,error:h.funDate}),(0,d.jsx)(al,{label:"Payee",type:"text",name:"payee",register:e,error:h.payee}),(0,d.jsx)("div",{className:"col-span-2",children:(0,d.jsx)(al,{label:"Remarks",type:"textarea",name:"fundRemarks",register:e,error:h.fundRemarks})}),(0,d.jsx)(al,{label:"Fund Amount",type:"number",name:"fundAmount",register:e,error:h.fundAmount,disabled:!0}),(0,d.jsx)(al,{label:"Misc Expenses",type:"number",name:"miscExp",register:e,error:h.miscExp}),(0,d.jsx)(al,{label:"Power, Light, & Water",type:"number",name:"powerLight",register:e,error:h.powerLight}),(0,d.jsx)(al,{label:"Telephone Post. & Tel.",type:"number",name:"telephone",register:e,error:h.telephone}),(0,d.jsx)(al,{label:"Due to MH",type:"number",name:"dueToMh",register:e,error:h.dueToMh})]}),(0,d.jsx)("div",{className:"flex flex-row justify-end gap-2 ",children:(0,d.jsx)(p.A,{label:"Add Travel Funds",size:"sm",icon:(0,d.jsx)(am.A,{}),type:"button",variant:"success",onClick:u})})]}),(0,d.jsxs)("section",{className:"addded-section",children:[(0,d.jsx)("div",{className:"header py-1",children:(0,d.jsx)("h4",{className:"font-semibold text-[#333333]",children:"Added Travel Fund"})}),(0,d.jsxs)("table",{className:"added-list w-full border border-gray-300",children:[(0,d.jsx)("thead",{className:"bg-green-800 text-white",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Date"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Payee"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Remarks"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Amount"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Misc. Exp."}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Power, Light, & Water"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Telephone POST. & TEL."}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Due to MH"})]})}),(0,d.jsx)("tbody",{children:0===l.length?(0,d.jsx)("tr",{className:"bg-gray-100",children:(0,d.jsx)("td",{colSpan:8,className:"text-center p-2",children:"No records added yet."})}):l.map((a,b)=>(0,d.jsxs)("tr",{className:"bg-gray-100",children:[(0,d.jsx)("td",{className:"p-2 text-center",children:a.funDate?new Date(a.funDate).toLocaleDateString():"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:a.payee??"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:a.fundRemarks??"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:"number"==typeof a.fundAmount?w(a.fundAmount):"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:"number"==typeof a.miscExp?w(a.miscExp):"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:"number"==typeof a.powerLight?w(a.powerLight):"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:"number"==typeof a.telephone?w(a.telephone):"-"}),(0,d.jsx)("td",{className:"p-2 text-center",children:"number"==typeof a.dueToMh?w(a.dueToMh):"-"})]},b))}),(0,d.jsx)("tfoot",{children:(0,d.jsxs)("tr",{className:"bg-gray-50 font-semibold",children:[(0,d.jsx)("td",{className:"p-2 text-right",children:"Total"}),(0,d.jsx)("td",{className:"p-2"}),(0,d.jsx)("td",{className:"p-2"}),(0,d.jsx)("td",{className:"p-2",children:w(v.fundTotal)}),(0,d.jsx)("td",{className:"p-2",children:w(v.miscTotal)}),(0,d.jsx)("td",{className:"p-2",children:w(v.powerTotal)}),(0,d.jsx)("td",{className:"p-2",children:w(v.teleTotal)}),(0,d.jsx)("td",{className:"p-2",children:w(v.dueTotal)})]})})]})]})]})};var ap=c(59556);async function aq(a){let{data:b}=await ap.A.post("/request/add-count-sheet",a,{withCredentials:!0});return b}var ar=c(79284),as=c(36450);let at=a=>a.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),au=({onClose:a,data:b,items:c,checkedTotal:e,fundsAmount:f,grandTotal:g,approvers:h})=>{let i=(Number(b.fundAmount)||0)-g;return(0,d.jsxs)("div",{className:"space-y-4 relative min-h-[320px] max-h-[70vh] overflow-auto",children:[(0,d.jsxs)("header",{className:"text-center",children:[(0,d.jsx)("h3",{className:"font-semibold",children:"EMB CAPITAL LENDING CORPORATION"}),(0,d.jsx)("h6",{children:"Cash Count Sheet"})]}),(0,d.jsxs)("section",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"font-medium",children:"Office:"})," ",b.office]}),(0,d.jsxs)("div",{children:["  ",(0,d.jsx)("span",{className:"font-medium",children:"Date Counted:"})," ",b.dateCounted?new Date(b.dateCounted).toLocaleDateString("en-PH",{year:"numeric",month:"short",day:"2-digit"}):""]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"font-medium",children:"Reference:"})," ",b.reference]})]}),(0,d.jsxs)("div",{children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"font-medium",children:"Name of Fund:"})," ",b.nameFund]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"font-medium",children:"Fund Amount:"})," ",at(Number(b.fundAmount)||0)]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"font-medium",children:"Cash-Short (Over):"})," ",at(i)]})]})]}),(0,d.jsxs)("section",{children:[(0,d.jsx)("h6",{className:"font-semibold mb-2",children:"Fund Counted as Follows"}),(0,d.jsxs)("table",{className:"w-full text-sm border border-gray-300",children:[(0,d.jsx)("thead",{className:"bg-gray-100",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"text-left p-2",children:"Denomination"}),(0,d.jsx)("th",{className:"text-center p-2",children:"Pieces"}),(0,d.jsx)("th",{className:"text-right p-2",children:"Amount"}),(0,d.jsx)("th",{className:"text-center p-2",children:"Checked"})]})}),(0,d.jsx)("tbody",{children:c.map(a=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"p-2",children:at(a.denom)}),(0,d.jsx)("td",{className:"p-2 text-center",children:a.pieces}),(0,d.jsx)("td",{className:"p-2 text-right",children:at(a.amount)}),(0,d.jsx)("td",{className:"p-2 text-center",children:a.checked?"✓":""})]},a.denom))}),(0,d.jsx)("tfoot",{children:(0,d.jsxs)("tr",{className:"bg-gray-50 font-semibold",children:[(0,d.jsx)("td",{className:"p-2",children:"Totals"}),(0,d.jsx)("td",{className:"p-2"}),(0,d.jsx)("td",{className:"p-2 text-right",children:at(e)}),(0,d.jsx)("td",{className:"p-2"})]})})]})]}),(0,d.jsxs)("section",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"font-medium",children:"Replenishment Amount:"})," ",at(f)]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("span",{className:"font-medium",children:"Grand Total (Replenishment + Checked):"})," ",at(g)]})]}),(0,d.jsx)(u.A,{approverList:h}),(0,d.jsx)("div",{className:"flex justify-end",children:(0,d.jsx)(p.A,{label:"Cancel",size:"sm",icon:(0,d.jsx)(as.A,{}),type:"button",variant:"secondary",onClick:a})})]})},av=[1e3,500,200,100,50,20,10,5,1,.25];function aw({requestTypeId:a,requestType:b}){let c=(0,m.mN)({resolver:(0,o.u)(n.jJ),defaultValues:{requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}}),{control:g,register:h,handleSubmit:i,formState:{errors:j},setValue:l,getValues:r}=c,{data:s}=(0,k.XU)(),t=(s??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),{data:u=[]}=(0,k.In)(),v=u.map(a=>({value:a.id,label:a.branchName||a.companyName})),[z,B]=(0,e.useState)(1e9),[C,D]=(0,e.useState)(av.map(a=>({denom:a,pieces:0,checked:!1}))),[E,F]=(0,e.useState)(null),[G,H]=(0,e.useState)(null),[I,J]=(0,e.useState)(null),[K,L]=(0,e.useState)(!1),[M,N]=f().useState([]),[O,P]=f().useState([]),[Q,R]=(0,e.useState)(0),[S,T]=(0,e.useState)(null),{data:U}=(0,w.rA)(),V=a=>a.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),W=(0,e.useMemo)(()=>C.reduce((a,b)=>b.checked?a+(Number(b.pieces)||0)*(Number(b.denom)||0):a,0),[C]),X=(0,e.useMemo)(()=>(Number(z)||0)+(Number(W)||0),[z,W]),{reset:Y}=c,Z=()=>L(!1);return(0,d.jsx)(m.Op,{...c,children:(0,d.jsx)("form",{onSubmit:i(c=>{let d=[],e=U?.branch?.coordinatorId;c.approvers&&(d=[{id:c.approvers?.checkedById??null,roleType:"checkedById"},{id:c.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:c.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:c.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:c.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:c.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:c.approvers?.approveById??null,roleType:"approveById"},{id:c.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>null!==a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:e??null};else if(4===a.id&&U?.branchId)return{...a,id:y(u,U?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&U?.branch?{...a,id:x(U?.branch?.branchName)}:a}));let f=c.denoms.map((a,b)=>({denom:a,pieces:c.pieces[b],amount:c.amounts[b],checked:c.checked?.[b]??!1})).filter(a=>a.checked),g=b?.requestName==="FUND REPLENISHMENT"?"Cash":b?.requestName==="TRAVEL REPLENISHMENT"?"Travel":"Cash",h=Number(c.fundAmount),i=Number(X),j=Number.isFinite(h)?h:0,k=Number.isFinite(i)?i:0,l=Math.round(100*(j-k))/100,m={fundType:g,repFund:z,totalFund:k,requestTypeId:a,branchId:Number(c.branch),office:c.office,dateCounted:c.dateCounted?new Date(c.dateCounted).toISOString().slice(0,19).replace("T"," "):void 0,nameFund:c.nameFund,fundAmount:j,reference:c.reference,cashDemo:f,..."Travel"===g?{travelRows:M}:{},..."Cash"===g?{cashRows:O}:{},fundPerCount:c.fundPerCount,cashShort:l};aq({...m,approvers:d}).then(()=>{Y(),D(av.map(a=>({denom:a,pieces:0,checked:!1}))),N([]),P([]),B(0),R(a=>a+1),T(S),ar.A.successAlert("Submit Fund","Fund Submitted Successfully")})},a=>{console.log("Validation errors:",a)}),className:"w-[min(90rem,100%)] mx-auto my-4 ",children:(0,d.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,d.jsxs)("div",{className:"bg-white px-8 py-6 rounded-md flex flex-col gap-y-4",children:[(0,d.jsxs)("div",{className:"flex flex-col items-center text-center w-full py-2",children:[(0,d.jsx)("h3",{className:"font-semibold",children:"EMB CAPITAL LENDING CORPORATION"}),(0,d.jsx)("h6",{children:"CASH COUNT SHEET"})]}),(0,d.jsxs)("div",{className:"flex flex-row w-full gap-6",children:[(0,d.jsx)(al,{label:"Office",type:"text",name:"office",register:h,error:j?.office,placeholder:"Please Enter Office"}),(0,d.jsx)(al,{label:"Enter Company Branch",type:"select",register:h,name:"branch",error:j?.branch,options:v})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-y-4",children:[(0,d.jsxs)("div",{className:"flex flex-row gap-x-6",children:[(0,d.jsx)(al,{label:"Name of Fund",type:"text",name:"nameFund",register:h,error:j?.nameFund,placeholder:"Please Enter Fund Name"}),(0,d.jsx)(al,{label:"Date Counted",type:"date",name:"dateCounted",register:h,error:j?.dateCounted})]}),(0,d.jsxs)("div",{className:"flex flex-row gap-x-6",children:[(0,d.jsx)(al,{label:"Reference",type:"text",name:"reference",register:h,error:j?.reference,placeholder:"Please Enter Reference"}),(0,d.jsx)(al,{label:"Fund Amount",type:"number",name:"fundAmount",register:h,error:j?.fundAmount,placeholder:"Please Enter Fund Amount"})]})]}),(0,d.jsx)("h6",{className:"font-semibold text-base px-2",children:"Fund Counted as Follows"}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsxs)("table",{className:"added-list w-full border border-gray-300",children:[(0,d.jsx)("thead",{className:"bg-green-800 text-white",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 font-semibold text-left",children:"Cash Denomination"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"No. of Pieces"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-right",children:"Amount"}),(0,d.jsx)("th",{className:"p-2 font-semibold text-center",children:"Checked"})]})}),(0,d.jsx)("tbody",{children:C.map((a,b)=>(0,d.jsxs)("tr",{className:"bg-gray-100 font-medium text-[1rem]",children:[(0,d.jsx)("td",{className:"py-[0.5rem] px-2 text-left",children:V(a.denom)}),(0,d.jsxs)("td",{className:"py-[0.5rem] px-2 text-center",onDoubleClick:()=>F(b),children:[E===b?(0,d.jsx)("input",{type:"number",autoFocus:!0,min:0,className:"w-24 border rounded px-2 py-1 text-center outline-none",value:a.pieces,onChange:a=>{var c;return c=Number(a.target.value),void D(a=>a.map((a,d)=>d===b?{...a,pieces:Math.max(0,Number(c)||0)}:a))},onBlur:()=>F(null),onKeyDown:a=>{("Enter"===a.key||"Escape"===a.key)&&F(null)}}):(0,d.jsx)("span",{className:"cursor-text select-none",children:a.pieces}),(0,d.jsx)("input",{type:"hidden",...h(`pieces.${b}`),value:a.pieces,readOnly:!0}),(0,d.jsx)("input",{type:"hidden",...h(`denoms.${b}`),value:a.denom,readOnly:!0})]}),(0,d.jsxs)("td",{className:"py-[0.5rem] px-2 text-right",children:[a.pieces?V(a.pieces*a.denom):"-",(0,d.jsx)("input",{type:"hidden",...h(`amounts.${b}`),value:a.pieces*a.denom,readOnly:!0})]}),(0,d.jsxs)("td",{className:"py-[0.5rem] px-2 text-center",children:[(0,d.jsx)("input",{type:"checkbox",checked:a.checked,onChange:a=>{var c;return c=a.target.checked,void D(a=>a.map((a,d)=>d===b?{...a,checked:c}:a))}}),(0,d.jsx)("input",{type:"hidden",...h(`checked.${b}`),value:a.checked?"true":"false",readOnly:!0})]})]},a.denom))}),(0,d.jsx)("tfoot",{children:(0,d.jsxs)("tr",{className:"bg-gray-50 font-semibold",children:[(0,d.jsx)("td",{className:"py-4 text-left px-6 font-normal",children:"Total"}),(0,d.jsx)("td",{className:"p-2"}),(0,d.jsx)("td",{className:"p-2 text-right",children:V(W)}),(0,d.jsx)("td",{className:"p-2"})]})})]})})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-4",children:[b?.requestName=="TRAVEL REPLENISHMENT"&&(0,d.jsxs)("div",{children:[(0,d.jsx)("h6",{className:"font-semibold text-base px-2",children:"Traveling Fund Replenishment"}),(0,d.jsx)(an,{amount:z,onChange:B,onDataChange:N,office:c.getValues("office"),branch:v.find(a=>String(a.value)===String(c.getValues("branch")))?.label||"",resetSignal:Q})]}),b?.requestName=="FUND REPLENISHMENT"&&(0,d.jsxs)("div",{children:[(0,d.jsx)("h6",{className:"font-semibold text-base px-2",children:"Cash Fund Replenishment"}),(0,d.jsx)(ao,{amount:z,onChange:B,onDataChange:P,office:c.getValues("office"),branch:v.find(a=>String(a.value)===String(c.getValues("branch")))?.label||"",resetSignal:Q})]})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-4 ",children:[(0,d.jsx)("h6",{className:"font-semibold text-base px-2",children:"Total Computation"}),(0,d.jsxs)("div",{className:"flex gap-x-2 justify-between bg-white px-8 py-6 rounded-md",children:[(0,d.jsx)(al,{label:"Total Fund Per Account",type:"number",name:"fundPerCount",register:h,error:j?.fundPerCount,placeholder:"0.00"}),(0,d.jsx)(al,{label:"Cash-Short (Over)",type:"number",name:"cashShort",register:h,error:j?.cashShort,placeholder:"0.00"})]})]}),(0,d.jsx)("div",{className:"flex w-full gap-6 mt-2 w-ful bg-white p-6",children:(0,d.jsx)(A,{setValue:l,getValues:r,control:g,approverData:t})}),(0,d.jsxs)("div",{className:"flex justify-end gap-6 mt-2 w-ful bg-white p-6",children:[(0,d.jsx)(p.A,{label:"Preview Cash Funding Sheets",size:"sm",icon:(0,d.jsx)(ai,{}),type:"button",onClick:()=>{let a=c.getValues(),b=a.denoms.map((b,c)=>({denom:b,pieces:a.pieces[c],amount:a.amounts[c],checked:a.checked?.[c]??!1})).filter(a=>a.checked);T(a.approvers),H(a),J(b),L(!0)},variant:"secondary"}),(0,d.jsx)(p.A,{label:"Submit Cash Count Sheet",size:"sm",icon:(0,d.jsx)(aj.A,{}),type:"submit"})]}),K&&G&&I&&(0,d.jsx)(q.A,{size:"lg",nested:!0,title:"Cash Count Sheet",onClose:Z,children:(0,d.jsx)(au,{onClose:Z,data:G,items:I,checkedTotal:W,fundsAmount:z,grandTotal:X,requestType:b,approvers:S})})]})})})}let ax=(0,h.A)((0,d.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Create"),ay=(0,h.A)((0,d.jsx)("path",{d:"M19 13H5v-2h14z"}),"Remove"),az=(0,h.A)((0,d.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.89-2-2-2m0 16H5V7h14zm-7-8.5c1.84 0 3.48.96 4.34 2.5-.86 1.54-2.5 2.5-4.34 2.5s-3.48-.96-4.34-2.5c.86-1.54 2.5-2.5 4.34-2.5M12 9c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 5.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5"}),"PreviewOutlined"),aA=(0,h.A)((0,d.jsx)("path",{d:"M9 16.17 4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"}),"Check"),aB=[{value:"Indexing",label:"Indexing for ID"},{value:"Date",label:"Date"},{value:"Text",label:"Text Input"},{value:"Number",label:"Number / Digits"},{value:"Qty",label:"Qty Per Unit"},{value:"Cost",label:"Total Cost for Qty"},{value:"Sum",label:"Sum"}],aC=({onClose:a,onConfirm:b,initialHeaders:c=[]})=>{let{register:f,handleSubmit:g,formState:{errors:h},reset:i}=(0,m.mN)({resolver:(0,o.u)(n.Pt),defaultValues:{}}),[j,k]=(0,e.useState)(c);return(0,d.jsxs)("form",{onSubmit:g(a=>{k(b=>[...b,a]),i()}),className:"flex flex-col gap-3",children:[(0,d.jsx)("ul",{className:"flex flex-col gap-3 px-4",children:(0,d.jsxs)("li",{className:"flex justify-between gap-4",children:[(0,d.jsx)(al,{label:"Table Header",type:"text",name:"tableHeader",register:f,error:h?.tableHeader,placeholder:"Enter table header..."}),(0,d.jsx)(al,{label:"Table Column Action",type:"select",name:"tableColAction",register:f,error:h?.tableColAction,options:aB}),(0,d.jsx)("div",{className:"flex items-end",children:(0,d.jsx)(p.A,{label:"Add Header",variant:"info",size:"md",icon:(0,d.jsx)(am.A,{}),type:"submit"})})]})}),(0,d.jsx)("div",{className:"px-4",children:j.length>0&&(0,d.jsx)("ul",{className:"list-disc pl-6 space-y-1",children:j.map((a,b)=>(0,d.jsxs)("li",{className:"flex items-center justify-between gap-2",children:[(0,d.jsxs)("span",{children:[a.tableHeader," (",a.tableColAction,")"]}),(0,d.jsx)("button",{type:"button",onClick:()=>k(a=>a.filter((a,c)=>c!==b)),className:"text-red-500 hover:text-red-700 text-sm",children:"✕"})]},b))})}),(0,d.jsxs)("div",{className:"flex justify-end gap-2 p-4",children:[(0,d.jsx)(p.A,{label:"Cancel",onClick:a,size:"md",icon:(0,d.jsx)(as.A,{}),variant:"secondary"}),(0,d.jsx)(p.A,{label:"Confirm Config",onClick:()=>{b&&b(j)},size:"md",icon:(0,d.jsx)(aA,{})})]})]})},aD=(0,h.A)((0,d.jsx)("path",{d:"M2.01 21 23 12 2.01 3 2 10l15 2-15 2z"}),"Send");var aE=c(8693),aF=c(54050);async function aG(a){let b=a instanceof FormData,{data:c}=await ap.A.post("/request/add-as-stated",a,{withCredentials:!0,headers:b?{"Content-Type":"multipart/form-data"}:{"Content-Type":"application/json"}});return c}var aH=c(30474);let aI=({onClose:a,table:b,images:c,requestTypeId:f,resetForm:g,approversArray:h,approvers:i})=>{let{watch:j}=(0,m.xW)(),{statedTo:l,statedFrom:n,statedDate:o,statedSubject:q,statedDetails:r}=j(),s=(0,e.useMemo)(()=>b?.headers?.length&&b?.rows?.length?b.headers.map(a=>{switch(a.tableColAction){case"Sum":return b.rows.map(b=>Number(b[a.tableHeader]??0)).reduce((a,b)=>a+(Number.isFinite(b)?b:0),0).toFixed(2);case"Average":return(b.rows.map(b=>Number(b[a.tableHeader]??0)).reduce((a,b)=>a+(Number.isFinite(b)?b:0),0)/b.rows.length).toFixed(2);case"Cost":{let c=b.headers.find(a=>"Qty"===a.tableColAction)?.tableHeader;if(!c)return"—";return b.rows.reduce((b,d)=>b+Number(d[c]??0)*Number(d[a.tableHeader]??0),0).toFixed(2)}default:return""}}):[],[b]),{data:t}=(0,w.rA)(),{data:v}=(0,k.XU)(),x=(v??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""}))??[],{data:y=[]}=(0,k.In)(),z=y.map(a=>({id:a.id??"",name:a.branchName??""})),A=(a,b)=>{if(!a)return"";let c=b.find(b=>b.id===a);return c?c.name:""},B=a=>{if(!a)return"—";let b=a instanceof Date?a:new Date(String(a));return Number.isNaN(b.getTime())?"—":b.toLocaleDateString()},C=function(){let a=(0,aE.jE)();return(0,aF.n)({mutationFn:a=>aG(a),onSuccess:b=>{console.log("Fund created successfully:",b),a.invalidateQueries({queryKey:["approvals"]})},onError:a=>{console.error("Error creating fund:",a)}})}();return(0,d.jsxs)("div",{className:"flex flex-col gap-6 relative min-h-[320px] max-h-[70vh] overflow-auto",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-1 w-full justify-center items-center text-center",children:[(0,d.jsx)("h1",{className:"text-xl font-bold",children:"EMB CAPITAL LENDING CORPORATION"}),(0,d.jsx)("h3",{className:"text-lg font-semibold",children:t?.branchName}),(0,d.jsx)("p",{className:"text-lg",children:"454-1192"})]}),(0,d.jsxs)("div",{className:"border-t border-b border-gray-300 py-4 grid grid-cols-2 gap-4",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-2 px-4",children:[(0,d.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,d.jsx)("h3",{className:"text-md font-semibold w-24",children:"TO :"}),(0,d.jsx)("p",{className:"text-sm",children:A(l,x)||(0,d.jsx)("span",{className:"text-gray-400",children:"—"})})]}),(0,d.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,d.jsx)("h3",{className:"text-md font-semibold w-24",children:"FROM :"}),(0,d.jsx)("p",{className:"text-sm",children:A(n,z)||(0,d.jsx)("span",{className:"text-gray-400",children:"—"})})]})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-2 px-4",children:[(0,d.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,d.jsx)("h3",{className:"text-md font-semibold w-24",children:"DATE :"}),(0,d.jsx)("p",{className:"text-sm",children:B(o)})]}),(0,d.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,d.jsx)("h3",{className:"text-md font-semibold w-24",children:"SUBJECT :"}),(0,d.jsx)("p",{className:"text-sm",children:q||(0,d.jsx)("span",{className:"text-gray-400",children:"—"})})]})]})]}),(0,d.jsxs)("div",{className:"px-4",children:[(0,d.jsx)("h1",{className:"text-md font-semibold text-gray-600 mb-2",children:"Good Day!"}),(0,d.jsx)("p",{className:"whitespace-pre-wrap",children:r||(0,d.jsx)("span",{className:"text-gray-400",children:"No details provided."})})]}),!!b?.headers?.length&&(0,d.jsx)("div",{className:"px-4",children:(0,d.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,d.jsx)("thead",{children:(0,d.jsx)("tr",{children:b.headers.map((a,b)=>(0,d.jsx)("th",{className:"border border-gray-300 px-2 py-1",children:a.tableHeader},b))})}),(0,d.jsx)("tbody",{children:b.rows.map((a,c)=>(0,d.jsx)("tr",{children:b.headers.map((b,e)=>{let f="Indexing"===b.tableColAction,g="Date"===b.tableColAction,h=a[b.tableHeader],i=null;return f?i=c+1:g&&h?i=B(h):null!=h&&(i=String(h)),(0,d.jsx)("td",{className:"border border-gray-300 px-2 py-1",children:i??""},e)})},c))}),(0,d.jsx)("tfoot",{children:(0,d.jsx)("tr",{children:s.map((a,b)=>(0,d.jsx)("td",{className:"border border-gray-300 px-2 py-1 font-semibold text-right",children:a},b))})})]})}),(0,d.jsxs)("div",{className:"px-4",children:[(0,d.jsx)("h1",{className:"text-md font-semibold text-gray-600",children:"Your prompt approval with regards to this request will be appreciated."}),(0,d.jsx)("h1",{className:"text-md font-semibold text-gray-600",children:"Thank you and God Bless."})]}),!!c?.length&&(0,d.jsxs)("div",{className:"px-4",children:[(0,d.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Attached image(s):"}),(0,d.jsx)("div",{className:"flex flex-wrap -mx-2",children:c.map((a,b)=>(0,d.jsx)("div",{className:"w-1/3 px-2 mb-4",children:(0,d.jsx)(aH.default,{src:"string"==typeof a?a:URL.createObjectURL(a),alt:`preview-${b}`,width:300,height:160,className:"w-full h-40 object-cover rounded border"})},b))})]}),(0,d.jsx)(u.A,{approverList:i}),(0,d.jsxs)("div",{className:"flex justify-end",children:[(0,d.jsx)(p.A,{label:"Submit",onClick:()=>{let d=b?.headers&&["denom","amount","pieces","checked"].every(a=>b.headers.some(b=>b.tableHeader.toLowerCase()===a)),e=b?d?b.rows.map(a=>({denom:Number(a.denom??0),amount:Number(a.amount??0),pieces:Number(a.pieces??0),checked:!!a.checked})):b.rows:null,i=new FormData;if(h?.length){let a=h.map(a=>({id:a.id?Number(a.id):null,roleType:a.roleType??null}));i.append("approvers",JSON.stringify(a))}if(i.append("statedTo",String(l??"")),i.append("statedFrom",String(n??"")),o&&i.append("statedDate",new Date(o).toISOString()),i.append("statedSub",q??""),i.append("statedDetails",r??""),i.append("requestTypeId",String(f)),e&&b?.headers?.length){let a=b.headers.map(a=>a.tableHeader),c=e.map(b=>a.map(a=>b[a]??""));s?.length&&c.push(a.map((a,b)=>s[b]??"")),i.append("statedTable",JSON.stringify({headers:a,rows:c}))}c?.length&&c.forEach(a=>{a instanceof File&&i.append("images",a)}),C.mutate(i,{onSuccess:()=>{ar.A.successAlert("Submit Fund","Fund Submitted Successfully"),g?.(),a?.()}})},size:"sm",icon:(0,d.jsx)(aD,{})}),(0,d.jsx)(p.A,{label:"Close",onClick:a,size:"sm",icon:(0,d.jsx)(as.A,{}),variant:"secondary"})]})]})};function aJ({requestTypeId:a,requestType:b}){let[c,f]=(0,e.useState)(!1),[g,h]=(0,e.useState)(!1),[i,l]=(0,e.useState)([]),[r,s]=(0,e.useState)([]),[t,u]=(0,e.useState)([]),[v,z]=(0,e.useState)([]),[B,C]=(0,e.useState)([]),[D,E]=(0,e.useState)(null),{data:F}=(0,k.XU)(),{data:G=[]}=(0,k.In)(),{data:H}=(0,w.rA)(),I=(F??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),J=G.map(a=>({id:a.id??"",name:a.branchName??""})),K=(0,m.mN)({resolver:(0,o.u)(n.Zq),defaultValues:{statedDate:new Date,statedSubject:"",statedDetails:"",requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}}),{control:L,register:M,formState:{errors:N},reset:O,getValues:P,setValue:Q}=K,R=async()=>{if(!await K.trigger())return;let a=P(),b=H?.branch?.coordinatorId;E(a.approvers),a.approvers&&l([{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>null!==a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b??null};else if(4===a.id&&H?.branchId)return{...a,id:y(G,H?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&H?.branch?{...a,id:x(H?.branch?.branchName)}:a})),h(!0)},S=()=>h(!1),T=()=>f(!1);return(0,d.jsx)(m.Op,{...K,children:(0,d.jsxs)("div",{className:"flex flex-col gap-4 w-[min(90rem,100%)] mx-auto my-4 p-6 rounded-lg bg-white",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-1 w-full justify-center items-center text-center",children:[(0,d.jsx)("h1",{className:"text-xl font-bold",children:H?.branch?.companyName??"EMB CAPITAL LENDING CORPORATION"}),(0,d.jsx)("h3",{className:"text-lg font-semibold",children:H?.branch?.branchName??"EMB BRANCH"}),(0,d.jsx)("p",{className:"text-lg",children:H?.branch?.telephone??""})]}),(0,d.jsxs)("div",{className:"border-t border-b border-gray-400 py-4 flex w-full gap-2",children:[(0,d.jsxs)("div",{className:"flex flex-col gap-2 px-4 w-full",children:[(0,d.jsxs)("div",{className:"flex gap-2 items-center py-1.5",children:[(0,d.jsx)("h3",{className:"text-md font-semibold w-24",children:"TO:"}),(0,d.jsx)(m.xI,{name:"statedTo",control:L,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:I,placeholder:"Select request to...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})]}),(0,d.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,d.jsx)("h3",{className:"text-md font-semibold w-24",children:"FROM:"}),(0,d.jsx)(m.xI,{name:"statedFrom",control:L,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:J,placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})]})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-2 px-4 w-full",children:[(0,d.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,d.jsx)("h3",{className:"text-md font-semibold w-24",children:"DATE:"}),(0,d.jsx)(al,{type:"date",name:"statedDate",register:M,error:N?.statedDate})]}),(0,d.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,d.jsx)("h3",{className:"text-md font-semibold w-24",children:"SUBJECT:"}),(0,d.jsx)(al,{type:"text",name:"statedSubject",register:M,error:N?.statedSubject,placeholder:"Enter Stated Subject"})]})]})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-2 px-4",children:[(0,d.jsx)("h1",{className:"text-lg font-semibold text-gray-600",children:"Good Day!"}),(0,d.jsx)(al,{type:"textarea",name:"statedDetails",register:M,error:N?.statedDetails,placeholder:"Enter Request details or content..."})]}),(0,d.jsxs)("div",{className:"flex flex-col gap-4 px-4",children:[(0,d.jsx)("div",{className:"flex justify-start gap-6 mt-2 w-full",children:(0,d.jsx)(p.A,{label:r.length>0?"Edit Table":"Create Table",onClick:()=>f(!0),size:"md",icon:(0,d.jsx)(ax,{})})}),(0,d.jsx)("div",{className:"border-t border-b border-gray-400 py-4 flex w-full gap-2 p-4",children:0===r.length?(0,d.jsx)("h5",{className:"text-md font-normal text-gray-400",children:"No data available yet."}):(0,d.jsx)("div",{className:"w-full",children:(0,d.jsxs)("table",{className:"w-full border-collapse border border-gray-300",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[r.map((a,b)=>(0,d.jsx)("th",{className:"border border-gray-300 px-2 py-1",children:a.tableHeader},b)),(0,d.jsx)("th",{className:"border border-gray-300 px-2 py-1",children:"Actions"})]})}),(0,d.jsx)("tbody",{children:t.map((a,b)=>(0,d.jsxs)("tr",{children:[r.map((c,e)=>{let f=["Sum","Average","Number","Qty"].includes(c.tableColAction),g="Indexing"===c.tableColAction,h="Date"===c.tableColAction;return(0,d.jsx)("td",{className:"border border-gray-300 px-2 py-1",children:g?(0,d.jsx)("span",{children:b+1}):(0,d.jsx)("input",{type:h?"date":f?"number":"text",step:f?"0.01":void 0,className:"w-full px-1 py-0.5 border rounded",value:a[c.tableHeader]??"",onChange:a=>{let d=f?parseFloat(a.target.value)||0:a.target.value;u(a=>a.map((a,e)=>e===b?{...a,[c.tableHeader]:d}:a)),b===t.length-1&&""!==d&&u(a=>[...a,Object.fromEntries(r.map(b=>[b.tableHeader,"Indexing"===b.tableColAction?a.length+1:""]))])}})},e)}),(0,d.jsx)("td",{className:"border border-gray-300 px-2 py-1 text-center",children:(0,d.jsx)(p.A,{label:"Delete",onClick:()=>u(a=>a.filter((a,c)=>c!==b)),size:"sm",icon:(0,d.jsx)(ay,{}),variant:"danger"})})]},b))})]})})})]}),(0,d.jsx)("div",{className:"border-t border-b border-gray-400 py-4 flex w-full gap-2 mt-8",children:(0,d.jsxs)("div",{className:"flex flex-col gap-4 px-4 w-full",children:[(0,d.jsx)("p",{className:"text-sm font-normal text-gray-600",children:"If it requires proof of purchase or images, upload file here:"}),(0,d.jsxs)("label",{className:"w-fit inline-flex items-center gap-2 px-3 py-2 border border-gray-500 rounded-md cursor-pointer hover:bg-gray-100",children:[(0,d.jsx)("input",{type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:a=>{let b=Array.from(a.target.files??[]);if(0===b.length)return;let c=new Set(v.map(a=>`${a.name}-${a.size}`)),d=b.filter(a=>!c.has(`${a.name}-${a.size}`));z(a=>[...a,...d])}}),(0,d.jsx)("span",{className:"text-sm font-medium text-gray-500",children:"Upload images"})]}),B.length>0&&(0,d.jsx)("div",{className:"flex flex-wrap -mx-2",children:B.map((a,b)=>(0,d.jsx)("div",{className:"w-1/3 px-2 mb-4",children:(0,d.jsxs)("div",{className:"relative",children:[(0,d.jsx)("img",{src:a,alt:`upload-${b}`,className:"w-full h-40 object-cover rounded border"}),(0,d.jsx)("button",{type:"button",onClick:()=>{z(a=>a.filter((a,c)=>c!==b))},className:"absolute top-2 right-2 bg-white/90 border rounded px-2 py-1 text-xs hover:bg-white","aria-label":"Remove image",children:"Remove"})]})},b))})]})}),(0,d.jsx)("div",{className:"py-4 flex w-full gap-2 mt-8",children:(0,d.jsx)(A,{control:L,approverData:I,setValue:Q,getValues:P})}),(0,d.jsx)("div",{className:"flex justify-end gap-6 mt-2 w-full",children:(0,d.jsx)(p.A,{label:"Preview Form",onClick:R,size:"md",icon:(0,d.jsx)(az,{})})}),c&&(0,d.jsx)(q.A,{size:"lg",nested:!0,title:"Configure Table Requirements",onClose:T,children:(0,d.jsx)(aC,{onClose:T,onConfirm:a=>{s(a),T()},initialHeaders:r})}),g&&(0,d.jsx)(q.A,{size:"lg",nested:!0,title:"Preview As Stated Form",onClose:S,children:(0,d.jsx)(aI,{onClose:S,table:{headers:r,rows:t},images:v,requestTypeId:a,requestType:b,approversArray:i,approvers:D,resetForm:()=>{K.reset({requestTypeId:a,statedDate:new Date,statedDetails:"",statedSubject:"",approvers:{checkedById:b?.checkedById??void 0,checkedBy2Id:b?.checkedBy2Id??void 0,recomApprovalId:b?.recomApprovalId??void 0,recomApproval2Id:b?.recomApproval2Id??void 0,approveById:b?.approveById??void 0,approveBy2Id:b?.approveBy2Id??void 0,checkedBy3Id:b?.checkedBy3Id??void 0,checkedBy4Id:b?.checkedBy4Id??void 0}}),s([]),u([]),z([]),C([])}})})]})})}var aK=c(9640);function aL({requestTypeId:a,requestType:b}){let{data:c}=(0,w.rA)(),{data:f=[]}=(0,k.In)(),{data:h}=(0,k.XU)(),[i,n]=(0,e.useState)(null),[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(null),v=(h??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),z=f.map(a=>({id:a.id??"",name:a.branchName??""})),{control:B,register:C,handleSubmit:D,reset:E,setValue:F,getValues:H,formState:{errors:I}}=(0,m.mN)({resolver:(0,o.u)(G),defaultValues:{requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}}),{fields:J,append:K,remove:L}=(0,m.jz)({control:B,name:"items"}),{fields:M,append:N,remove:O}=(0,m.jz)({control:B,name:"inventory_data"});return(0,d.jsxs)("div",{className:"bg-white border border-[#ECECEC] min-h-70 px-3 py-10 rounded-md",children:[(0,d.jsx)("div",{children:(0,d.jsx)("h2",{className:"p-4 font-extrabold text-2xl text-center text-gray-700",children:"OFFICE SUPPLIES REQUISITION FORM"})}),(0,d.jsx)("form",{onSubmit:D(a=>{u(a.approvers);let b=c?.branch?.coordinatorId,d=[{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b};else if(4===a.id&&c?.branchId)return{...a,id:y(f,c?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&c?.branch?{...a,id:x(c?.branch?.branchName)}:a});n({...a,approvers:d}),s(!0)}),children:(0,d.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(20rem,1fr))] gap-4 p-4 mt-8",children:[(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestToId",control:B,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:v,label:"Request To",placeholder:"Select request to...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestFromId",control:B,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:z,label:"Branch",placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Date",placeholder:"Enter Date...",register:C("date"),error:I.date,type:"date"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"From",placeholder:"Enter Date...",register:C("from_name"),error:I.from_name,type:"text"})}),(0,d.jsx)("div",{className:"flex col-span-2",children:(0,d.jsx)(l.sO,{label:"Request Description",placeholder:"description...",register:C("request_description"),error:I.request_description})}),(0,d.jsxs)("div",{className:"col-span-full overflow-x-auto",children:[(0,d.jsxs)("table",{className:"min-w-full border border-gray-200 text-sm",children:[(0,d.jsx)("thead",{className:"bg-gray-100",children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"px-3 py-2 border border-gray-300",children:"Description"}),(0,d.jsx)("th",{className:"px-3 py-2 border border-gray-300",children:"Quantity"}),(0,d.jsx)("th",{className:"px-3 py-2 border border-gray-300",children:"Last Request Date"}),(0,d.jsx)("th",{className:"px-3 py-2 border border-gray-300",children:"Allocation"}),(0,d.jsx)("th",{className:"px-3 py-2 border border-gray-300",children:"Remarks"}),(0,d.jsx)("th",{className:"px-3 py-2 border border-gray-300 w-16",children:"Action"})]})}),(0,d.jsx)("tbody",{children:J.map((a,b)=>(0,d.jsxs)("tr",{className:"odd:bg-white even:bg-gray-50",children:[(0,d.jsx)("td",{className:"px-3 py-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Description",register:C(`items.${b}.item_description`),error:I.items?.[b]?.item_description})}),(0,d.jsx)("td",{className:"px-3 py-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Quantity",register:C(`items.${b}.quantity`),error:I.items?.[b]?.quantity})}),(0,d.jsx)("td",{className:"px-3 py-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"date",placeholder:"Last Request Date",register:C(`items.${b}.date_of_last_request`),error:I.items?.[b]?.date_of_last_request})}),(0,d.jsx)("td",{className:"px-3 py-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Allocation",register:C(`items.${b}.allocation`),error:I.items?.[b]?.allocation})}),(0,d.jsx)("td",{className:"px-3 py-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Remarks",register:C(`items.${b}.remarks`),error:I.items?.[b]?.remarks})}),(0,d.jsx)("td",{className:"px-3 py-2 border border-gray-300 text-center",children:(0,d.jsx)("button",{type:"button",disabled:1===J.length,onClick:()=>L(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},a.id))})]}),(0,d.jsx)("div",{className:"mt-4",children:(0,d.jsx)("button",{type:"button",onClick:()=>K({item_description:"",quantity:"",date_of_last_request:"",allocation:"",remarks:""}),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"✚ Add Item"})})]}),(0,d.jsxs)("div",{className:"col-span-full mt-8",children:[(0,d.jsx)("div",{className:"",children:(0,d.jsx)("h2",{className:"font-extrabold text-xl text-center text-gray-700",children:"OFFICE SUPPLIES INVENTORY"})}),(0,d.jsx)("div",{className:"mt-6",children:(0,d.jsxs)("table",{className:"w-full border border-gray-300",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Description"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Unit"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Beginning"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Ending"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Utilized"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Remarks"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Checkbox"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Action"})]})}),(0,d.jsx)("tbody",{children:M.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Description..",register:C(`inventory_data.${b}.inventory_description`),error:I.inventory_data?.[b]?.inventory_description})}),(0,d.jsx)("td",{className:"p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Unit..",register:C(`inventory_data.${b}.unit`),error:I.inventory_data?.[b]?.unit})}),(0,d.jsx)("td",{className:"p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Beginning..",register:C(`inventory_data.${b}.beginning`),error:I.inventory_data?.[b]?.beginning})}),(0,d.jsx)("td",{className:"p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Ending..",register:C(`inventory_data.${b}.ending`),error:I.inventory_data?.[b]?.ending})}),(0,d.jsx)("td",{className:"p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Utilized..",register:C(`inventory_data.${b}.utilized`),error:I.inventory_data?.[b]?.utilized})}),(0,d.jsx)("td",{className:"p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Remarks..",register:C(`inventory_data.${b}.remarks`),error:I.inventory_data?.[b]?.remarks})}),(0,d.jsx)("td",{className:"p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"checkbox",placeholder:"Checkbox..",register:C(`inventory_data.${b}.checkbox`),error:I.inventory_data?.[b]?.checkbox})}),(0,d.jsx)("td",{className:"px-3 py-2 border border-gray-300 text-center",children:(0,d.jsx)("button",{type:"button",onClick:()=>O(b),disabled:1===M.length,className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},b))})]})}),(0,d.jsx)("div",{className:"mt-4",children:(0,d.jsx)("button",{type:"button",onClick:()=>N({inventory_description:"",unit:"",beginning:"",ending:"",utilized:"",remarks:"",checkbox:!1}),className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"✚ Add Inventory"})})]}),(0,d.jsx)("div",{className:"col-span-full mt-10",children:(0,d.jsx)(A,{control:B,approverData:v,setValue:F,getValues:H})}),(0,d.jsx)("div",{className:"col-span-full flex justify-end mt-3",children:(0,d.jsx)(p.A,{label:"Submit",size:"md",type:"submit",icon:(0,d.jsx)(g.A,{})})})]})}),r&&(0,d.jsx)(q.A,{size:"xl",children:(0,d.jsx)(aK.A,{onClose:()=>{s(!1)},onReset:()=>{E()},formData:i,requestType:b,approvers:t})})]})}var aM=c(34400);function aN({requestTypeId:a,requestType:b}){let{data:c}=(0,w.rA)(),{data:f=[]}=(0,k.In)(),{data:h}=(0,k.XU)(),[i,n]=(0,e.useState)(null),[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(null),[v,z]=(0,e.useState)(0),[B,C]=(0,e.useState)([]),[D,E]=(0,e.useState)([]),F=(h??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),G=f.map(a=>({id:a.id??"",name:a.branchName??""})),{control:H,register:I,handleSubmit:K,reset:L,getValues:M,setValue:N,formState:{errors:O}}=(0,m.mN)({resolver:(0,o.u)(J),defaultValues:{requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}});return(0,d.jsxs)("div",{className:"bg-white border border-[#ECECEC] min-h-70 px-3 py-10 rounded-md",children:[(0,d.jsx)("div",{children:(0,d.jsx)("h2",{className:"p-4 font-extrabold text-2xl text-center text-gray-700",children:"PRE-SIGNING"})}),(0,d.jsx)("form",{onSubmit:K(a=>{u(a.approvers);let b=c?.branch?.coordinatorId,d=[{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b};else if(4===a.id&&c?.branchId)return{...a,id:y(f,c?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&c?.branch?{...a,id:x(c?.branch?.branchName)}:a});n({...a,table_data:{headers:B,rows:D},approvers:d}),s(!0)}),children:(0,d.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(25rem,1fr))] gap-4 p-4 mt-8",children:[(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestToId",control:H,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:F,label:"Request To",placeholder:"Select request to...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestFromId",control:H,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:G,label:"Branch",placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Date",register:I("date"),error:O.date,type:"date"})}),(0,d.jsxs)("div",{className:"grid grid-cols-2 col-span-full gap-x-4",children:[(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(l.sO,{label:"Description",register:I("request_description"),error:O.request_description})}),(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(l.sO,{label:"Note",register:I("request_note"),error:O.request_note})})]}),(0,d.jsx)("div",{className:"flex flex-col col-span-full w-4/12",children:(0,d.jsx)(l.Pd,{label:"Number of columns",register:I("numCols",{valueAsNumber:!0,onChange:a=>{let b=Number(a.target.value);b>0?(z(b),C(Array(b).fill("")),E([Array(b).fill("")])):(z(0),C([]),E([]))}}),placeholder:"Enter a number...",type:"number"})}),v>0&&(0,d.jsxs)("div",{className:"p-4 col-span-full",children:[(0,d.jsx)("h3",{className:"font-semibold mb-2",children:"DEFINE COLUMN HEADERS"}),(0,d.jsx)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(10rem,1fr))] gap-2",children:B.map((a,b)=>(0,d.jsx)("input",{type:"text",placeholder:`Column ${b+1}`,value:a,onChange:a=>{var c;return c=a.target.value,void C(a=>{let d=a.map((a,d)=>d===b?c:a);return N("headers",d),d})},className:"border border-gray-300 bg-gray-50 rounded-lg p-2"},b))})]}),(0,d.jsx)("div",{className:"col-span-full",children:D.length>0&&(0,d.jsx)("div",{className:"overflow-x-auto p-4",children:(0,d.jsxs)("table",{className:"w-full border border-gray-300",children:[(0,d.jsx)("thead",{children:(0,d.jsx)("tr",{children:B.map((a,b)=>(0,d.jsx)("th",{className:"border border-gray-300 p-2 bg-gray-100 text-sm",children:a||`Column ${b+1}`},b))})}),(0,d.jsx)("tbody",{children:D.map((a,b)=>(0,d.jsxs)("tr",{children:[a.map((a,c)=>(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)("input",{type:"text",value:a,onChange:a=>{var d;return d=a.target.value,void E(a=>{let e=a.map((a,e)=>e===b?a.map((a,b)=>b===c?d:a):a);if(0===c&&b===a.length-1&&""!==d.trim()){let a=[...e,Array(v).fill("")];return N("rows",a),a}return N("rows",e),e})},className:"w-full border border-gray-300 rounded p-1"})},c)),(0,d.jsx)("td",{className:"border border-gray-300 p-2 text-center",children:D.length>1&&(0,d.jsx)("button",{type:"button",onClick:()=>{E(a=>a.filter((a,c)=>c!==b))},className:"bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded-md",children:"\uD83D\uDDD1"})})]},b))})]})})}),(0,d.jsx)("div",{className:"col-span-full mt-10",children:(0,d.jsx)(A,{control:H,approverData:F,setValue:N,getValues:M})}),(0,d.jsx)("div",{className:"col-span-full flex justify-end mt-3",children:(0,d.jsx)(p.A,{label:"Submit",size:"md",type:"submit",icon:(0,d.jsx)(g.A,{})})})]})}),r&&(0,d.jsx)(q.A,{size:"xl",children:(0,d.jsx)(aM.A,{onClose:()=>{s(!1)},onReset:()=>{L(),C([]),E([]),z(0)},formData:{...i,headers:B,rows:D},requestType:b,approvers:t})})]})}var aO=c(33288);function aP({requestTypeId:a,requestType:b}){let{data:c}=(0,w.rA)(),{data:f=[]}=(0,k.In)(),{data:h}=(0,k.XU)(),[i,n]=(0,e.useState)(null),[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(null),v=(h??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),z=f.map(a=>({id:a.id??"",name:a.branchName??""})),{control:B,register:C,handleSubmit:D,reset:E,setValue:F,getValues:G,formState:{errors:H}}=(0,m.mN)({resolver:(0,o.u)(K),defaultValues:{requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}});return(0,d.jsxs)("div",{className:"bg-white border border-[#ECECEC] min-h-70 px-3 py-10 rounded-md",children:[(0,d.jsx)("div",{children:(0,d.jsx)("h2",{className:"p-4 font-extrabold text-2xl text-center text-gray-700",children:"PAST DUE ENDORSEMENT"})}),(0,d.jsx)("form",{onSubmit:D(a=>{u(a.approvers);let b=c?.branch?.coordinatorId,d=[{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b};else if(4===a.id&&c?.branchId)return{...a,id:y(f,c?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&c?.branch?{...a,id:x(c?.branch?.branchName)}:a});n({...a,approvers:d}),s(!0)}),children:(0,d.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(18rem,1fr))] gap-4 p-4 mt-8",children:[(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestFromId",control:B,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:z,label:"Branch",placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Date Endorsed",register:C("date_endorsed"),error:H.date_endorsed,type:"date"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"ID No",register:C("id_no"),error:H.id_no,type:"text"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Pensioner Name",register:C("name_of_pensioner"),error:H.name_of_pensioner,type:"text"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Bank",register:C("bank"),error:H.bank,type:"text"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Type of Pension",register:C("type_of_pension"),error:H.type_of_pension,type:"text"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Age",register:C("age"),error:H.age,type:"text"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Date In",register:C("date_in"),error:H.date_in,type:"date"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"First Collection Effectivity",register:C("first_coll_effect"),error:H.first_coll_effect,type:"date"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Last Transaction",register:C("last_transaction"),error:H.last_transaction,type:"date"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"Transaction Type",register:C("transaction_type"),error:H.transaction_type,type:"text"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"No of Months Overdue",register:C("no_of_months_overdue"),error:H.no_of_months_overdue,type:"text"})}),(0,d.jsx)("div",{className:"flex flex-col",children:(0,d.jsx)(l.Pd,{label:"With Insurance/ICOD",register:C("with_insurance_icod"),error:H.with_insurance_icod,type:"text"})}),(0,d.jsx)("div",{className:"col-span-3",children:(0,d.jsx)(l.sO,{label:"Reason for no Insurance",register:C("reason_for_no_insurance"),error:H.reason_for_no_insurance})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Loan balance as of",register:C("loan_balance_as_of"),error:H.loan_balance_as_of,type:"date"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Total LR",register:C("total_lr",{valueAsNumber:!0}),error:H.total_lr,type:"number",step:"any"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Total AP",register:C("total_ap",{valueAsNumber:!0}),error:H.total_ap,type:"number",step:"any"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Total UDI",register:C("total_udi",{valueAsNumber:!0}),error:H.total_udi,type:"number",step:"any"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Total IDE",register:C("total_ide",{valueAsNumber:!0}),error:H.total_ide,type:"number",step:"any"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Reason for non-collection of account",register:C("reason_for_non_coll_acc"),error:H.reason_for_non_coll_acc,type:"text"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Co-Maker",register:C("co_maker"),error:H.co_maker,type:"text"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Relation to SSP",register:C("relation_to_ssp"),error:H.relation_to_ssp,type:"text"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Contact Number",register:C("contact_number"),error:H.contact_number,type:"text"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Compromise Payment",register:C("compromise_payment"),error:H.compromise_payment,type:"text"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Payment Start",register:C("payment_start"),error:H.payment_start,type:"text"})}),(0,d.jsx)("div",{className:"col-span-2",children:(0,d.jsx)(l.sO,{label:"Action Taken",register:C("action_taken"),error:H.action_taken})}),(0,d.jsx)("div",{className:"col-span-full mt-15 border-t border-gray-300 pt-4",children:(0,d.jsx)(A,{control:B,approverData:v,setValue:F,getValues:G})}),(0,d.jsx)("div",{className:"col-span-full flex justify-end mt-3",children:(0,d.jsx)(p.A,{label:"Preview",size:"md",type:"submit",icon:(0,d.jsx)(g.A,{})})})]})}),r&&(0,d.jsx)(q.A,{size:"xl",children:(0,d.jsx)(aO.A,{onClose:()=>{s(!1)},onReset:()=>{E()},formData:i,requestType:b,approvers:t})})]})}var aQ=c(37207);function aR(a,b,c,d){let f=()=>b.reduce((a,b)=>{let c=d&&b in d?d[b]:"number"==typeof({})[b]?0:"";return a[b]=c,a},{}),[g,h]=(0,e.useState)([f()]),i=b=>{h(b),c(a,b,{shouldValidate:!0})};return{list:g,handleChange:(a,b,c)=>{let d=[...g];d[a]={...d[a],[b]:c??""};let e=a===g.length-1,h=Object.values(d[a]).some(a=>"number"==typeof a?0!==a:""!==String(a).trim());e&&h&&d.push(f()),i(d)},handleMultiChange:(a,b)=>{let c=[...g];c[a]={...c[a],...b};let d=a===g.length-1,e=Object.values(c[a]).some(a=>""!==String(a).trim());d&&e&&c.push(f()),i(c)},handleDelete:a=>{let b=g.filter((b,c)=>c!==a);0===b.length&&b.push(f()),i(b)},setList:h,resetList:()=>{i([f()])}}}function aS({requestTypeId:a,requestType:b}){let{data:c}=(0,w.rA)(),{data:f=[]}=(0,k.In)(),{data:h}=(0,k.XU)(),[i,n]=(0,e.useState)(null),[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(null),v=(h??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),z=f.map(a=>({id:a.id??"",name:a.branchName??""})),{control:B,register:C,handleSubmit:D,reset:E,getValues:F,setValue:G,formState:{errors:H}}=(0,m.mN)({resolver:(0,o.u)(R),defaultValues:{requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}}),{list:I,handleChange:J,handleDelete:K,resetList:L}=aR("destination_list",["destination_name"],G),{list:M,handleChange:N,handleDelete:O,resetList:P,handleMultiChange:Q}=aR("travel_details_list",["date","day","from","to","transportation_services","or_number","amount"],G,{amount:0}),{list:S,handleChange:T,handleDelete:U,handleMultiChange:V,resetList:W}=aR("computation_list",["computation_date","branch_name","beg","ending","kilometers_consume","consumption_km","gas_liter_consume","gas_price_per_liter"],G,{beg:0,ending:0,kilometers_consume:0,consumption_km:0,gas_liter_consume:0,gas_price_per_liter:0}),{list:X,handleChange:Y,handleDelete:Z,resetList:$}=aR("breakdown_expenses_list",["branch_name","transpo","fuel","meals","accomodation"],G,{transpo:0,fuel:0,meals:0,accomodation:0});return(0,d.jsxs)("div",{className:"bg-white border border-[#ECECEC] min-h-70 px-3 py-10 rounded-md",children:[(0,d.jsx)("div",{children:(0,d.jsx)("h2",{className:"p-2 font-extrabold text-2xl text-center text-gray-700",children:"FSM TRAVEL LIQUIDATION"})}),(0,d.jsx)("form",{onSubmit:D(a=>{u(a.approvers);let b=c?.branch?.coordinatorId,d=[{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b};else if(4===a.id&&c?.branchId)return{...a,id:y(f,c?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&c?.branch?{...a,id:x(c?.branch?.branchName)}:a});n({...a,approvers:d}),s(!0)}),children:(0,d.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(25rem,1fr))] gap-4 p-4 mt-8",children:[(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestFromId",control:B,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:z,label:"Branch",placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Name",register:C("name"),error:H.name,type:"text"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Trip Ticket #",register:C("trip_ticket_number"),error:H.trip_ticket_number,type:"text"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Approved Budget",register:C("approved_budget",{valueAsNumber:!0}),error:H.approved_budget,type:"number"})}),(0,d.jsxs)("div",{className:"col-span-full mt-4",children:[(0,d.jsx)("h2",{className:"font-bold text-slate-800 mb-2",children:"DESTINATION:"}),(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"DESTINATION"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"ACTION"})]})}),(0,d.jsx)("tbody",{children:I.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.destination_name,onChange:a=>J(b,"destination_name",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.destination_list?.[b]?.destination_name&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.destination_list[b]?.destination_name?.message})]}),(0,d.jsx)("td",{className:"border border-gray-300",children:(0,d.jsx)("button",{disabled:1===I.length,type:"button",onClick:()=>K(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600  disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},b))})]})]}),(0,d.jsxs)("div",{className:"col-span-full mt-4",children:[(0,d.jsx)("h2",{className:"font-bold text-slate-800 mb-2",children:"TRAVEL DETAILS:"}),(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"DATE"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"DAY"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"FROM"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"TO"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"TRANSPORTATION & SERVICES"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"OR NUMBER"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"AMOUNT"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"ACTION"})]})}),(0,d.jsx)("tbody",{children:M.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"date",value:a.date,onChange:a=>{let c=a.target.value;if(c){let a=new Date(c).toLocaleDateString("en-US",{weekday:"short"}).toUpperCase();N(b,"date",c),Q(b,{date:c,day:a})}else Q(b,{date:"",day:""})},className:"w-full border border-gray-300 rounded p-2"}),H.travel_details_list?.[b]?.date&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.travel_details_list[b]?.date?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.day,onChange:a=>N(b,"day",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.travel_details_list?.[b]?.day&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.travel_details_list[b]?.day?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.from,onChange:a=>N(b,"from",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.travel_details_list?.[b]?.from&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.travel_details_list[b]?.from?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.to,onChange:a=>N(b,"to",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.travel_details_list?.[b]?.to&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.travel_details_list[b]?.to?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.transportation_services,onChange:a=>N(b,"transportation_services",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.travel_details_list?.[b]?.transportation_services&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.travel_details_list[b]?.transportation_services?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.or_number,onChange:a=>N(b,"or_number",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.travel_details_list?.[b]?.or_number&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.travel_details_list[b]?.or_number?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"number",value:0===a.amount?"":a.amount,onChange:a=>{let c=a.target.value;N(b,"amount",""===c?0:Number(c))},className:"w-full border border-gray-300 rounded p-2"}),H.travel_details_list?.[b]?.amount&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.travel_details_list[b]?.amount?.message})]}),(0,d.jsx)("td",{className:"border border-gray-300",children:(0,d.jsx)("button",{type:"button",disabled:1===M.length,onClick:()=>O(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},b))})]})]}),(0,d.jsxs)("div",{className:"col-span-full mt-4",children:[(0,d.jsx)("h2",{className:"font-bold text-slate-800 mb-2",children:"COMPUTATION:"}),(0,d.jsxs)("div",{className:"flex flex-row gap-x-4 py-4",children:[(0,d.jsx)(l.Pd,{label:"DATE FROM",register:C("computation_date_from"),error:H.computation_date_from,type:"date"}),(0,d.jsx)(l.Pd,{label:"DATE TO",register:C("computation_date_to"),error:H.computation_date_to,type:"date"})]}),(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsxs)("thead",{children:[(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-400",rowSpan:2,children:"BRANCH"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"DATE"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",colSpan:2,children:"ODOMETER READING"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"KILOMETERS"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"CONSUMPTION"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"GAS-LITER"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"GAS PRICE"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",rowSpan:2,children:"ACTION"})]}),(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-400"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"BEG"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"ENDING"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"CONSUME"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"KM/PER LITER"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"CONSUME"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"PER LITER"})]})]}),(0,d.jsx)("tbody",{children:S.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.branch_name,className:"w-full border border-gray-300 rounded p-2",onChange:a=>T(b,"branch_name",a.target.value)}),H.computation_list?.[b]?.branch_name&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.computation_list[b]?.branch_name?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"date",value:a.computation_date,onChange:a=>T(b,"computation_date",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.computation_list?.[b]?.computation_date&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.computation_list[b]?.computation_date?.message})]}),(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)("input",{type:"number",value:0===a.beg?"":a.beg,onChange:c=>{let d=""===c.target.value?0:Number(c.target.value),e=(Number(a.ending)||0)-d,f=Number(a.consumption_km)||0;V(b,{beg:d,kilometers_consume:e,gas_liter_consume:0===f?0:e/f})},className:"w-full border border-gray-300 rounded p-2",placeholder:"0"})}),(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)("input",{type:"number",value:0===a.ending?"":a.ending,onChange:c=>{let d=""===c.target.value?0:Number(c.target.value),e=d-(Number(a.beg)||0),f=Number(a.consumption_km)||0;V(b,{ending:d,kilometers_consume:e,gas_liter_consume:0===f?0:e/f})},className:"w-full border border-gray-300 rounded p-2",placeholder:"0"})}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"number",value:0===a.kilometers_consume?"":a.kilometers_consume,readOnly:!0,className:"w-full border border-gray-300 rounded p-2"}),H.computation_list?.[b]?.kilometers_consume&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.computation_list[b]?.kilometers_consume?.message})]}),(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)("input",{type:"number",value:0===a.consumption_km?"":a.consumption_km,onChange:c=>{let d=""===c.target.value?0:Number(c.target.value),e=Number(a.kilometers_consume)||0;V(b,{consumption_km:d,gas_liter_consume:0===d?0:e/d})},className:"w-full border border-gray-300 rounded p-2",placeholder:"0"})}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"number",value:0===a.gas_liter_consume?"":a.gas_liter_consume,readOnly:!0,className:"w-full border border-gray-300 rounded p-2"}),H.computation_list?.[b]?.gas_liter_consume&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.computation_list[b]?.gas_liter_consume?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"number",value:0===a.gas_price_per_liter?"":a.gas_price_per_liter,onChange:a=>{let c=a.target.value;T(b,"gas_price_per_liter",""===c?0:Number(c))},className:"w-full border border-gray-300 rounded p-2"}),H.computation_list?.[b]?.gas_price_per_liter&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.computation_list[b]?.gas_price_per_liter?.message})]}),(0,d.jsx)("td",{className:"border border-gray-300",children:(0,d.jsx)("button",{disabled:1===S.length,type:"button",onClick:()=>U(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600  disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},b))})]})]}),(0,d.jsxs)("div",{className:"col-span-full mt-4",children:[(0,d.jsx)("h2",{className:"font-bold text-slate-800 mb-2",children:"BREAKDOWN OF EXPENSES FOR BRANCHES:"}),(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"BRANCH"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"TRANSPO"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"FUEL"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"MEALS"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"ACCOMODATION"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"ACTION"})]})}),(0,d.jsx)("tbody",{children:X.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.branch_name,onChange:a=>Y(b,"branch_name",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.breakdown_expenses_list?.[b]?.branch_name&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.breakdown_expenses_list[b]?.branch_name?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"number",value:0===a.transpo?"":a.transpo,onChange:a=>{let c=a.target.value;Y(b,"transpo",""===c?0:Number(c))},className:"w-full border border-gray-300 rounded p-2"}),H.breakdown_expenses_list?.[b]?.transpo&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.breakdown_expenses_list[b]?.transpo?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"number",value:0===a.fuel?"":a.fuel,onChange:a=>{let c=a.target.value;Y(b,"fuel",""===c?0:Number(c))},className:"w-full border border-gray-300 rounded p-2"}),H.breakdown_expenses_list?.[b]?.fuel&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.breakdown_expenses_list[b]?.fuel?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"number",value:0===a.meals?"":a.meals,onChange:a=>{let c=a.target.value;Y(b,"meals",""===c?0:Number(c))},className:"w-full border border-gray-300 rounded p-2"}),H.breakdown_expenses_list?.[b]?.meals&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.breakdown_expenses_list[b]?.meals?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"number",value:0===a.accomodation?"":a.accomodation,onChange:a=>{let c=a.target.value;Y(b,"accomodation",""===c?0:Number(c))},className:"w-full border border-gray-300 rounded p-2"}),H.breakdown_expenses_list?.[b]?.accomodation&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.breakdown_expenses_list[b]?.accomodation?.message})]}),(0,d.jsx)("td",{className:"border border-gray-300",children:(0,d.jsx)("button",{disabled:1===X.length,type:"button",onClick:()=>Z(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600  disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},b))})]})]}),(0,d.jsx)("div",{className:"col-span-full mt-10",children:(0,d.jsx)(A,{control:B,approverData:v,setValue:G,getValues:F})}),(0,d.jsx)("div",{className:"col-span-full flex justify-end mt-3",children:(0,d.jsx)(p.A,{label:"Submit",size:"md",type:"submit",icon:(0,d.jsx)(g.A,{})})})]})}),r&&(0,d.jsx)(q.A,{size:"xl",children:(0,d.jsx)(aQ.A,{onClose:()=>{s(!1)},onReset:()=>{L(),P(),W(),$(),E()},formData:i,requestType:b,approvers:t})})]})}var aT=c(58283);function aU({requestTypeId:a,requestType:b}){let{data:c}=(0,w.rA)(),{data:f=[]}=(0,k.In)(),{data:h}=(0,k.XU)(),[i,n]=(0,e.useState)(null),[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(null),v=(h??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),z=f.map(a=>({id:a.id??"",name:a.branchName??""})),{control:B,register:C,handleSubmit:D,reset:E,setValue:F,getValues:G,formState:{errors:H}}=(0,m.mN)({resolver:(0,o.u)(T),defaultValues:{requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}}),{list:I,handleChange:J,handleDelete:K,resetList:L}=aR("table_data",["date","approved_weekly_itinerary","purpose","deviation"],F);return(0,d.jsxs)("div",{className:"bg-white border border-[#ECECEC] min-h-70 px-3 py-8 rounded-md",children:[(0,d.jsx)("div",{className:"p-1.5",children:(0,d.jsx)("h3",{className:"text-2xl font-extrabold text-gray-600 text-center",children:"WEEKLY ITINERARY DEVIATION"})}),(0,d.jsx)("form",{onSubmit:D(a=>{u(a.approvers);let b=c?.branch?.coordinatorId,d=[{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b};else if(4===a.id&&c?.branchId)return{...a,id:y(f,c?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&c?.branch?{...a,id:x(c?.branch?.branchName)}:a});n({...a,approvers:d}),s(!0)}),children:(0,d.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(25rem,1fr))] gap-4 p-4 mt-8",children:[(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestFromId",control:B,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:z,label:"Branch",placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Date",register:C("cur_date"),error:H.cur_date,type:"date"})}),(0,d.jsxs)("div",{className:"col-span-full mt-4",children:[(0,d.jsx)("h2",{className:"font-bold text-slate-800 mb-2",children:"ITINERARY APPROVAL FORM:"}),(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"DATE"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"APPROVE WEEKLY ITINERARY"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"PURPOSE"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"DEVIATION"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"ACTION"})]})}),(0,d.jsx)("tbody",{children:I.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"date",value:a.date,onChange:a=>J(b,"date",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.table_data?.[b]?.date&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.table_data[b]?.date?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.approved_weekly_itinerary,onChange:a=>J(b,"approved_weekly_itinerary",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.table_data?.[b]?.approved_weekly_itinerary&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.table_data[b]?.approved_weekly_itinerary?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.purpose,onChange:a=>J(b,"purpose",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.table_data?.[b]?.purpose&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.table_data[b]?.purpose?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.deviation,onChange:a=>J(b,"deviation",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.table_data?.[b]?.deviation&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.table_data[b]?.deviation?.message})]}),(0,d.jsx)("td",{className:"border border-gray-300",children:(0,d.jsx)("button",{disabled:1===I.length,type:"button",onClick:()=>K(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600  disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},b))})]})]}),(0,d.jsx)("div",{className:"col-span-full mt-10",children:(0,d.jsx)(A,{control:B,approverData:v,setValue:F,getValues:G})}),(0,d.jsx)("div",{className:"col-span-full flex justify-end mt-3",children:(0,d.jsx)(p.A,{label:"Submit",size:"md",type:"submit",icon:(0,d.jsx)(g.A,{})})})]})}),r&&(0,d.jsx)(q.A,{size:"xl",children:(0,d.jsx)(aT.A,{onClose:()=>{s(!1)},onReset:()=>{E(),L()},formData:i,requestType:b,approvers:t})})]})}var aV=c(90499);function aW({requestTypeId:a,requestType:b}){let{data:c}=(0,w.rA)(),{data:f=[]}=(0,k.In)(),{data:h}=(0,k.XU)(),[i,n]=(0,e.useState)(null),[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(null),v=(h??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),z=f.map(a=>({id:a.id??"",name:a.branchName??""})),{control:B,register:C,handleSubmit:D,reset:E,setValue:F,getValues:G,formState:{errors:H}}=(0,m.mN)({resolver:(0,o.u)(V),defaultValues:{requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}}),{list:I,handleChange:J,handleDelete:K,handleMultiChange:L,resetList:M}=aR("table_data",["date","days","branch","remarks"],F);return(0,d.jsxs)("div",{className:"bg-white border border-[#ECECEC] min-h-70 px-3 py-8 rounded-md",children:[(0,d.jsx)("div",{className:"p-1.5",children:(0,d.jsx)("h3",{className:"text-2xl font-extrabold text-gray-600 text-center",children:"FSM ITINERARY"})}),(0,d.jsx)("form",{onSubmit:D(a=>{u(a.approvers);let b=c?.branch?.coordinatorId,d=[{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b};else if(4===a.id&&c?.branchId)return{...a,id:y(f,c?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&c?.branch?{...a,id:x(c?.branch?.branchName)}:a});n({...a,approvers:d}),s(!0)}),children:(0,d.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(18rem,1fr))] gap-4 p-4 mt-8",children:[(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestFromId",control:B,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:z,label:"Branch",placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"From Date",register:C("from_date"),error:H.from_date,type:"date"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"To Date",register:C("to_date"),error:H.to_date,type:"date"})}),(0,d.jsxs)("div",{className:"col-span-full mt-4",children:[(0,d.jsx)("h2",{className:"font-bold text-slate-800 mb-2",children:"FIELD ITINERARY:"}),(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"DATE"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"DAYS"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"BRANCH"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"REMARKS"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"ACTION"})]})}),(0,d.jsx)("tbody",{children:I.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"date",value:a.date,onChange:a=>{let c=a.target.value;if(c){let a=new Date(c).toLocaleDateString("en-US",{weekday:"short"}).toUpperCase();J(b,"date",c),L(b,{date:c,days:a})}else L(b,{date:"",days:""})},className:"w-full border border-gray-300 rounded p-2"}),H.table_data?.[b]?.date&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.table_data[b]?.date?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.days,onChange:a=>J(b,"days",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.table_data?.[b]?.days&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.table_data[b]?.days?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.branch,onChange:a=>J(b,"branch",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.table_data?.[b]?.branch&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.table_data[b]?.branch?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.remarks,onChange:a=>J(b,"remarks",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.table_data?.[b]?.remarks&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.table_data[b]?.remarks?.message})]}),(0,d.jsx)("td",{className:"border border-gray-300",children:(0,d.jsx)("button",{disabled:1===I.length,type:"button",onClick:()=>K(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600  disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},b))})]})]}),(0,d.jsx)("div",{className:"col-span-full mt-10",children:(0,d.jsx)(A,{control:B,approverData:v,setValue:F,getValues:G})}),(0,d.jsx)("div",{className:"col-span-full flex justify-end mt-3",children:(0,d.jsx)(p.A,{label:"Submit",size:"md",type:"submit",icon:(0,d.jsx)(g.A,{})})})]})}),r&&(0,d.jsx)(q.A,{size:"xl",children:(0,d.jsx)(aV.A,{onClose:()=>{s(!1)},onReset:()=>{E(),M()},formData:i,requestType:b,approvers:t})})]})}var aX=c(21677);function aY({requestTypeId:a,requestType:b}){let{data:c}=(0,w.rA)(),{data:f=[]}=(0,k.In)(),{data:h}=(0,k.XU)(),[i,n]=(0,e.useState)(null),[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(null),v=(h??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),z=f.map(a=>({id:a.id??"",name:a.branchName??""})),{control:B,register:C,handleSubmit:D,reset:E,getValues:F,setValue:G,formState:{errors:H}}=(0,m.mN)({resolver:(0,o.u)(X),defaultValues:{requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}}),{list:I,handleChange:J,handleDelete:K,resetList:L}=aR("table_data",["date","particulars","amount"],G,{amount:0});return(0,d.jsxs)("div",{className:"bg-white border border-[#ECECEC] min-h-70 px-3 py-10 rounded-md",children:[(0,d.jsx)("div",{children:(0,d.jsx)("h2",{className:"p-2 font-extrabold text-2xl text-center text-gray-700",children:"TRAVEL ORDER LIQUIDATION"})}),(0,d.jsx)("form",{onSubmit:D(a=>{u(a.approvers);let b=c?.branch?.coordinatorId,d=[{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b};else if(4===a.id&&c?.branchId)return{...a,id:y(f,c?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&c?.branch?{...a,id:x(c?.branch?.branchName)}:a});n({...a,approvers:d}),s(!0)}),children:(0,d.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(18rem,1fr))] gap-4 p-4 mt-8",children:[(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestFromId",control:B,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:z,label:"Branch",placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Name",register:C("name"),error:H.name,type:"text"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Date Covered",register:C("date_covered"),error:H.date_covered,type:"date"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Purpose",register:C("purpose"),error:H.purpose,type:"text"})}),(0,d.jsxs)("div",{className:"col-span-full mt-4",children:[(0,d.jsx)("h2",{className:"font-bold text-slate-800 mb-2",children:"FIELD WEEKLY ITINERARY AND TRAVEL EXPENSE REPORT:"}),(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"DATE"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"PARTICULARS"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"AMOUNT"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300 bg-gray-200",children:"ACTION"})]})}),(0,d.jsx)("tbody",{children:I.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"date",value:a.date,onChange:a=>J(b,"date",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.table_data?.[b]?.date&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.table_data[b]?.date?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"text",value:a.particulars,onChange:a=>J(b,"particulars",a.target.value),className:"w-full border border-gray-300 rounded p-2"}),H.table_data?.[b]?.particulars&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.table_data[b]?.particulars?.message})]}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300",children:[(0,d.jsx)("input",{type:"number",value:0===a.amount?"":a.amount,onChange:a=>{let c=a.target.value;J(b,"amount",""===c?0:Number(c))},className:"w-full border border-gray-300 rounded p-2"}),H.table_data?.[b]?.amount&&(0,d.jsx)("p",{className:"text-red-500 text-xs mt-1",children:H.table_data[b]?.amount?.message})]}),(0,d.jsx)("td",{className:"border border-gray-300",children:(0,d.jsx)("button",{disabled:1===I.length,type:"button",onClick:()=>K(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600  disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},b))})]})]}),(0,d.jsx)("div",{className:"col-span-full mt-10",children:(0,d.jsx)(A,{control:B,approverData:v,setValue:G,getValues:F})}),(0,d.jsx)("div",{className:"col-span-full flex justify-end mt-3",children:(0,d.jsx)(p.A,{label:"Submit",size:"md",type:"submit",icon:(0,d.jsx)(g.A,{})})})]})}),r&&(0,d.jsx)(q.A,{size:"xl",children:(0,d.jsx)(aX.A,{onClose:()=>{s(!1)},onReset:()=>{E(),L()},formData:i,requestType:b,approvers:t})})]})}var aZ=c(76871),a$=c(53407);function a_({requestTypeId:a,requestType:b}){let{data:c}=(0,w.rA)(),{data:f=[]}=(0,k.In)(),{data:h}=(0,k.XU)(),[i,n]=(0,e.useState)(null),[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(null),[v,z]=(0,e.useState)(null),B=(h??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),C=f.map(a=>({id:a.id??"",name:a.branchName??""})),{control:D,register:E,handleSubmit:F,reset:G,setValue:H,getValues:I,watch:J,formState:{errors:K}}=(0,m.mN)({resolver:(0,o.u)($),defaultValues:{requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0},supplier_list:[{name:"",address:"",prices:[]},{name:"",address:"",prices:[]},{name:"",address:"",prices:[]}],items_list:[{item_name:"",qty:0,unit_of_quantity:"",po_unit_cost:void 0}]}}),{fields:L,append:M,remove:N}=(0,m.jz)({control:D,name:"items_list"}),O=J("items_list"),P=J("supplier_list"),Q=J("requestFromId"),{data:R}=(0,a$.kr)(Q?Number(Q):void 0);return(0,d.jsxs)("div",{className:"bg-white border border-[#ECECEC] min-h-70 px-3 py-8 rounded-md",children:[(0,d.jsx)("div",{className:"p-1.5",children:(0,d.jsx)("h3",{className:"text-2xl font-extrabold text-gray-600 text-center",children:"FFE PURCHASING FORM"})}),(0,d.jsx)("form",{onSubmit:F(a=>{u(a.approvers);let b=c?.branch?.coordinatorId,d=[{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b};else if(4===a.id&&c?.branchId)return{...a,id:y(f,c?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&c?.branch?{...a,id:x(c?.branch?.branchName)}:a});n({...a,approvers:d}),s(!0)}),children:(0,d.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(18rem,1fr))] gap-4 p-4 mt-8",children:[(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestFromId",control:D,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:C,label:"Branch",placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{children:(0,d.jsx)(l.Pd,{label:"Document Number",register:E("document_number"),error:K.document_number,type:"text"})}),(0,d.jsx)("div",{children:(0,d.jsx)(l.Pd,{label:"Date",register:E("date"),error:K.date,type:"date"})}),(0,d.jsxs)("div",{className:"col-span-full mt-8",children:[(0,d.jsx)("div",{className:"text-center font-bold text-gray-700",children:(0,d.jsx)("h2",{children:"I. PURCHASE REQUISITION"})}),(0,d.jsxs)("div",{className:"col-span-full mt-4",children:[(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Item Name"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Quantity"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Unit of Quantity"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300 w-1/12",children:"Action"})]})}),(0,d.jsx)("tbody",{children:L.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"item name",register:E(`items_list.${b}.item_name`),error:K.items_list?.[b]?.item_name})}),(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"Quantity",register:E(`items_list.${b}.qty`,{valueAsNumber:!0}),error:K.items_list?.[b]?.qty})}),(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Unit of quantity",register:E(`items_list.${b}.unit_of_quantity`),error:K.items_list?.[b]?.unit_of_quantity})}),(0,d.jsx)("td",{className:"border border-gray-300 w-1/12",children:(0,d.jsx)("button",{disabled:1===L.length,type:"button",onClick:()=>N(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},a.id))})]}),(0,d.jsx)("button",{type:"button",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 mt-4",onClick:()=>{M({item_name:"",qty:0,unit_of_quantity:"",po_unit_cost:void 0}),P.forEach((a,b)=>{H(`supplier_list.${b}.prices.${O.length}`,void 0)})},children:"✚ ADD ITEM"})]}),(0,d.jsx)("div",{className:"text-center font-bold text-gray-700",children:(0,d.jsx)("h2",{children:"II. CANVASS SHEET"})}),(0,d.jsx)("div",{className:"overflow-x-auto mt-4",children:(0,d.jsxs)("table",{className:"w-full border border-gray-300",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{className:"bg-gray-100 text-sm text-gray-700",children:[(0,d.jsx)("th",{className:"border border-gray-300 p-2 text-center",children:"ITEM"}),[1,2,3].map(a=>(0,d.jsxs)("th",{className:"border border-gray-300 p-2 text-center align-top",children:[(0,d.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,d.jsxs)("span",{children:["SUPPLIER ",a]}),(0,d.jsx)("input",{type:"checkbox",checked:v===a-1,onChange:()=>(a=>{z(a);let b=P[a]?.prices||[];O.forEach((a,c)=>{let d=b[c];"number"!=typeof d||isNaN(d)?H(`items_list.${c}.po_unit_cost`,void 0):H(`items_list.${c}.po_unit_cost`,d)})})(a-1)})]}),(0,d.jsxs)("div",{className:"mt-2",children:[(0,d.jsx)("input",{type:"text",placeholder:"Name",...E(`supplier_list.${a-1}.name`),className:"w-full border border-gray-300 bg-gray-50 rounded-lg p-1 mb-1 text-sm"}),(0,d.jsx)("input",{type:"text",placeholder:"Address",...E(`supplier_list.${a-1}.address`),className:"w-full border border-gray-300 bg-gray-50 rounded-lg p-1 text-sm"})]})]},a))]})}),(0,d.jsx)("tbody",{children:O?.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"text-center p-1 border border-gray-300 text-sm",children:a.item_name||`Item ${b+1}`}),[0,1,2].map(a=>(0,d.jsxs)("td",{className:"p-2 bg-gray-50 border border-gray-300",children:[(0,d.jsx)("input",{type:"number",step:"0.01",placeholder:"Unit price",...E(`supplier_list.${a}.prices.${b}`,{valueAsNumber:!0}),className:"w-full border border-gray-300 bg-white rounded-lg p-1 text-sm",onChange:c=>{if(E(`supplier_list.${a}.prices.${b}`).onChange(c),v===a){let a=parseFloat(c.target.value);H(`items_list.${b}.po_unit_cost`,isNaN(a)?void 0:a)}}}),K.supplier_list?.[a]?.prices?.[b]&&(0,d.jsx)("p",{className:"text-xs text-red-500 mt-1",children:String(K.supplier_list[a].prices?.[b]?.message)})]},a))]},b))})]})}),(0,d.jsx)("div",{className:"text-center font-bold text-gray-700 mt-8",children:(0,d.jsx)("h2",{children:"III. PURCHASE ORDER"})}),(0,d.jsx)("div",{className:"mt-4",children:(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Item Name"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"QTY"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Unit Cost"}),(0,d.jsx)("th",{className:"p-2 border border-gray-300",children:"Remarks"})]})}),(0,d.jsx)("tbody",{children:O&&O.length>0?O.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:a.item_name||`Item ${b+1}`}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:a.qty}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{register:E(`items_list.${b}.po_unit_cost`,{valueAsNumber:!0}),error:K.items_list?.[b]?.po_unit_cost,type:"number",step:"0.01",readonly:!0})}),(0,d.jsx)("td",{className:"border border-gray-300 p-2",children:(0,d.jsx)(l.Pd,{register:E(`items_list.${b}.remarks`),error:K.items_list?.[b]?.remarks,type:"text"})})]},b)):(0,d.jsx)("tr",{children:(0,d.jsx)("td",{colSpan:4,className:"text-gray-400 p-3",children:"No items added yet."})})})]})}),(0,d.jsx)("div",{className:"col-span-full mt-15 border-t border-gray-300 pt-4",children:(0,d.jsx)(A,{control:D,approverData:B,setValue:H,getValues:I})}),(0,d.jsx)("div",{className:"col-span-full flex justify-end mt-3",children:(0,d.jsx)(p.A,{label:"Submit",size:"md",type:"submit",icon:(0,d.jsx)(g.A,{})})})]})]})}),r&&(0,d.jsx)(q.A,{size:"xl",children:(0,d.jsx)(aZ.A,{onClose:()=>{s(!1)},onReset:()=>{G(),z(null)},formData:i,requestType:b,approvers:t})})]})}var a0=c(51514);let a1=(0,h.A)((0,d.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8"}),"AddCircleOutline");function a2({onClose:a,branchId:b}){let{register:c,handleSubmit:e,formState:{errors:f}}=(0,m.mN)({resolver:(0,o.u)(_)}),{mutate:h,isPending:i}=(0,a$.vJ)();return(0,d.jsx)("div",{className:"p-4",children:(0,d.jsxs)("form",{onSubmit:e(c=>{if(!b)return void ar.A.errorAlert("Please select a branch before adding suppliers.");h({branchId:b,...c},{onSuccess:()=>{ar.A.successAlert("Saved","New Supplier Saved Succesfully"),a()},onError:()=>{alert("Failed to add supplier. Please try again.")}})}),className:"grid grid-cols-[repeat(auto-fit,minmax(18rem,1fr))] gap-4 mt-6",children:[(0,d.jsxs)("div",{className:"flex flex-col",children:[(0,d.jsx)("label",{className:"mb-1 font-semibold text-base",children:"Supplier Name"}),(0,d.jsx)("input",{type:"text",...c("supplier_name"),className:"bg-gray-100 rounded border border-gray-300 px-4 py-2",placeholder:"Supplier name..."}),f.supplier_name&&(0,d.jsx)("p",{className:"text-red-500 text-sm",children:f.supplier_name.message})]}),(0,d.jsxs)("div",{className:"flex flex-col",children:[(0,d.jsx)("label",{className:"mb-1 font-semibold text-base",children:"Supplier Address"}),(0,d.jsx)("input",{type:"text",...c("supplier_address"),className:"bg-gray-100 rounded border border-gray-300 px-4 py-2",placeholder:"Supplier address..."}),f.supplier_address&&(0,d.jsx)("p",{className:"text-red-500 text-sm",children:f.supplier_address.message})]}),(0,d.jsxs)("div",{className:"col-span-full flex justify-end gap-x-4 mt-10",children:[(0,d.jsx)(p.A,{label:"Save",type:"submit",variant:"success",icon:(0,d.jsx)(g.A,{}),disabled:i}),(0,d.jsx)(p.A,{label:"Close",variant:"danger",onClick:a,icon:(0,d.jsx)(r.A,{})})]})]})})}function a3({requestTypeId:a,requestType:b}){let{data:c}=(0,w.rA)(),{data:f=[]}=(0,k.In)(),{data:h}=(0,k.XU)(),[i,n]=(0,e.useState)(null),[r,s]=(0,e.useState)(!1),[t,u]=(0,e.useState)(!1),[v,z]=(0,e.useState)(null),B=(h??[]).filter(a=>a.approver).map(a=>({id:a.id??"",name:a.name??""})),C=f.map(a=>({id:a.id??"",name:a.branchName??""})),{control:D,register:E,handleSubmit:F,reset:G,watch:H,setValue:I,getValues:J,formState:{errors:K}}=(0,m.mN)({resolver:(0,o.u)(ab),defaultValues:{requestTypeId:a,approvers:{checkedById:void 0,checkedBy2Id:void 0,checkedBy3Id:void 0,checkedBy4Id:void 0,recomApprovalId:void 0,recomApproval2Id:void 0,approveById:void 0,approveBy2Id:void 0}}}),{fields:L,append:M,remove:N}=(0,m.jz)({control:D,name:"items_list"}),O=H("requestFromId"),{data:P=[],isLoading:Q}=(0,a$.bv)(O),{refetch:R}=(0,a$.bv)(H("requestFromId")),{data:S}=(0,a$.kr)(O?Number(O):void 0),T=P.map((a,b)=>({id:b,name:a.supplier_name})),U=()=>{u(!0)};return(0,d.jsxs)("div",{className:"bg-white border border-[#ECECEC] min-h-70 px-3 py-10 rounded-md",children:[(0,d.jsx)("div",{children:(0,d.jsx)("h2",{className:"p-4 font-extrabold text-2xl text-center text-gray-700",children:"OFFICE SUPPLIES PURCHASING FORM"})}),(0,d.jsx)("form",{onSubmit:F(a=>{z(a.approvers);let b=c?.branch?.coordinatorId,d=[{id:a.approvers?.checkedById??null,roleType:"checkedById"},{id:a.approvers?.checkedBy2Id??null,roleType:"checkedBy2Id"},{id:a.approvers?.checkedBy3Id??null,roleType:"checkedBy3Id"},{id:a.approvers?.checkedBy4Id??null,roleType:"checkedBy4Id"},{id:a.approvers?.recomApprovalId??null,roleType:"recomApprovalId"},{id:a.approvers?.recomApproval2Id??null,roleType:"recomApproval2Id"},{id:a.approvers?.approveById??null,roleType:"approveById"},{id:a.approvers?.approveBy2Id??null,roleType:"approveBy2Id"}].filter(a=>a.id).map(a=>{if(["checkedById","checkedBy2Id","checkedBy3Id","checkedBy4Id"].includes(a.roleType)){if(2===a.id)return{...a,id:b};else if(4===a.id&&c?.branchId)return{...a,id:y(f,c?.branchId)}}return["recomApprovalId","recomApproval2Id"].includes(a.roleType)&&3===a.id&&c?.branch?{...a,id:x(c?.branch?.branchName)}:a});n({...a,approvers:d}),s(!0)}),children:(0,d.jsxs)("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(18rem,1fr))] gap-4 p-4 mt-8",children:[(0,d.jsx)("div",{className:"flex flex-row",children:(0,d.jsx)(m.xI,{name:"requestFromId",control:D,render:({field:a,fieldState:b})=>(0,d.jsx)(j.A,{data:C,label:"Branch",placeholder:"Select branch...",name:a.name,value:a.value,onChange:a.onChange,inputRef:a.ref,error:b.error})})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Document Number",register:E("document_number"),error:K.document_number,type:"text"})}),(0,d.jsx)("div",{className:"",children:(0,d.jsx)(l.Pd,{label:"Date",register:E("date"),error:K.date,type:"date"})}),(0,d.jsxs)("div",{className:"col-span-full mt-4",children:[(0,d.jsx)("h2",{className:"font-bold text-gray-700 mb-2",children:"ITEM LIST:"}),(0,d.jsxs)("table",{className:"w-full border border-gray-600 text-center",children:[(0,d.jsx)("thead",{children:(0,d.jsxs)("tr",{children:[(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Item Name"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Qty"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Unit of Quantity"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Unit Price"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Supplier Name"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400",children:"Remarks"}),(0,d.jsx)("th",{className:"p-2 border border-gray-400 w-1/12",children:"Action"})]})}),(0,d.jsx)("tbody",{children:L.map((a,b)=>(0,d.jsxs)("tr",{children:[(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"Item name..",register:E(`items_list.${b}.item_name`),error:K.items_list?.[b]?.item_name})}),(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"quantity..",register:E(`items_list.${b}.qty`,{valueAsNumber:!0}),error:K.items_list?.[b]?.qty})}),(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"unit of quantity..",register:E(`items_list.${b}.unit_of_qty`),error:K.items_list?.[b]?.unit_of_qty})}),(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"number",placeholder:"unit price..",register:E(`items_list.${b}.unit_price`,{valueAsNumber:!0}),error:K.items_list?.[b]?.unit_price})}),(0,d.jsxs)("td",{className:"bg-white p-2 border border-gray-300 flex gap-x-2",children:[(0,d.jsx)(m.xI,{name:`items_list.${b}.supplier_name`,control:D,render:({field:a,fieldState:c})=>(0,d.jsx)(j.A,{data:T,label:"",placeholder:Q?"Loading suppliers...":"Select supplier...",name:`items_list.${b}.supplier_name`,value:a.value,onChange:c=>{"string"==typeof c?a.onChange(c):c&&"object"==typeof c&&"name"in c?a.onChange(c.name):a.onChange("");let d="string"==typeof c?c:c?.name??"",e=P.find(a=>a.supplier_name===d);e?I(`items_list.${b}.supplier_address`,e.supplier_address):(a.onChange(""),I(`items_list.${b}.supplier_address`,""))},inputRef:a.ref,error:c.error,disabled:!O,returnField:"name"})}),(0,d.jsx)(p.A,{size:"md",onClick:U,icon:(0,d.jsx)(a1,{}),type:"button"})]}),(0,d.jsx)("td",{className:"bg-white p-2 border border-gray-300",children:(0,d.jsx)(l.Pd,{type:"text",placeholder:"unit of remarks..",register:E(`items_list.${b}.remarks`),error:K.items_list?.[b]?.remarks})}),(0,d.jsx)("td",{className:"border border-gray-300 w-1/12",children:(0,d.jsx)("button",{disabled:1===L.length,type:"button",onClick:()=>N(b),className:"px-2 py-1 bg-red-500 text-white rounded hover:bg-red-600 disabled:bg-red-300 disabled:cursor-not-allowed",children:"\uD83D\uDDD1"})})]},a.id))})]}),(0,d.jsx)("button",{type:"button",className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 mt-4",onClick:()=>M({unit_of_qty:"",qty:0,item_name:"",unit_price:0,supplier_name:"",supplier_address:"",remarks:""}),children:"✚ Add Item"})]}),(0,d.jsx)("div",{className:"col-span-full mt-15 border-t border-gray-300 pt-4",children:(0,d.jsx)(A,{control:D,approverData:B,setValue:I,getValues:J})}),(0,d.jsx)("div",{className:"col-span-full flex justify-end mt-3",children:(0,d.jsx)(p.A,{label:"Preview",size:"md",type:"submit",icon:(0,d.jsx)(g.A,{})})})]})}),t&&(0,d.jsx)(q.A,{size:"xl",title:"Add New Supplier",children:(0,d.jsx)(a2,{onClose:()=>{u(!1),u(!1),R()},branchId:H("requestFromId")})}),r&&(0,d.jsx)(q.A,{size:"xl",children:(0,d.jsx)(a0.A,{onClose:()=>{s(!1)},onReset:()=>{G()},formData:i,requestType:b,approvers:v})})]})}function a4(){let[a,b]=(0,e.useState)(null),[c,f]=(0,e.useState)(null),{data:g,isLoading:h}=(0,k.B6)(),i=(0,e.useMemo)(()=>{let a=new Map;return(g??[]).forEach(b=>a.set(b.id,b)),a},[g]);return h?(0,d.jsx)("div",{className:"p-2 text-sm text-gray-600",children:"Loading request types…"}):(0,d.jsxs)("div",{className:"flex flex-col",children:[(0,d.jsx)("div",{className:"py-4 px-2",children:(0,d.jsx)("h1",{className:"text-xl font-bold text-black",children:"Request Management Templates"})}),(0,d.jsx)("div",{className:"my-1",children:(0,d.jsxs)("select",{value:a??"",className:"bg-white border border-[#ECECEC] rounded-sm text-xs p-2",onChange:a=>{let c=a.currentTarget.value;if(""===c){b(null),f(null);return}let d=Number(c);b(d),f(i.get(d)??null)},children:[(0,d.jsx)("option",{value:"",children:"Select type…"}),g?.map(a=>(0,d.jsx)("option",{value:a.id,children:a.requestName},a.id))]})}),1===a&&(0,d.jsx)(B,{requestTypeId:a,requestType:c}),(2===a||38===a||39===a)&&(0,d.jsx)(ad,{requestTypeId:a,requestType:c}),3===a&&(0,d.jsx)(af,{requestTypeId:a,requestType:c}),4===a&&(0,d.jsx)(ah,{requestTypeId:a,requestType:c}),(5===a||6===a)&&(0,d.jsx)(aw,{requestTypeId:a,requestType:c}),7===a&&(0,d.jsx)(aL,{requestTypeId:a,requestType:c}),8===a&&(0,d.jsx)(a_,{requestTypeId:a,requestType:c}),9===a&&(0,d.jsx)(aN,{requestTypeId:a,requestType:c}),10===a&&(0,d.jsx)(aP,{requestTypeId:a,requestType:c}),null!==a&&[11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33].includes(a)&&(0,d.jsx)(aJ,{requestTypeId:a,requestType:c}),34===a&&(0,d.jsx)(aS,{requestTypeId:a,requestType:c}),35===a&&(0,d.jsx)(aU,{requestTypeId:a,requestType:c}),36===a&&(0,d.jsx)(aW,{requestTypeId:a,requestType:c}),37===a&&(0,d.jsx)(aY,{requestTypeId:a,requestType:c}),40===a&&(0,d.jsx)(a3,{requestTypeId:a,requestType:c})]})}},34631:a=>{"use strict";a.exports=require("tls")},41025:a=>{"use strict";a.exports=require("next/dist/server/app-render/dynamic-access-async-storage.external.js")},46662:(a,b,c)=>{Promise.resolve().then(c.bind(c,13862))},55511:a=>{"use strict";a.exports=require("crypto")},55591:a=>{"use strict";a.exports=require("https")},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63257:(a,b,c)=>{"use strict";c.r(b),c.d(b,{GlobalError:()=>C.a,__next_app__:()=>I,handler:()=>K,pages:()=>H,routeModule:()=>J,tree:()=>G});var d=c(65239),e=c(48088),f=c(47220),g=c(81289),h=c(26191),i=c(14823),j=c(71998),k=c(92603),l=c(54649),m=c(32781),n=c(82602),o=c(61268),p=c(4853),q=c(261),r=c(5052),s=c(9977),t=c(26713),u=c(43365),v=c(71454),w=c(67778),x=c(46143),y=c(39105),z=c(38171),A=c(86439),B=c(16133),C=c.n(B),D=c(30893),E=c(52836),F={};for(let a in D)0>["default","tree","pages","GlobalError","__next_app__","routeModule","handler"].indexOf(a)&&(F[a]=()=>D[a]);c.d(b,F);let G={children:["",{children:["request",{children:["submit-request",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(c.bind(c,13862)),"/app/app/request/submit-request/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(c.bind(c,42588)),"/app/app/request/layout.tsx"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,46055))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(c.bind(c,58014)),"/app/app/layout.tsx"],"global-error":[()=>Promise.resolve().then(c.t.bind(c,16133,23)),"next/dist/client/components/builtin/global-error.js"],"not-found":[()=>Promise.resolve().then(c.t.bind(c,80849,23)),"next/dist/client/components/builtin/not-found.js"],forbidden:[()=>Promise.resolve().then(c.t.bind(c,29868,23)),"next/dist/client/components/builtin/forbidden.js"],unauthorized:[()=>Promise.resolve().then(c.t.bind(c,79615,23)),"next/dist/client/components/builtin/unauthorized.js"],metadata:{icon:[async a=>(await Promise.resolve().then(c.bind(c,46055))).default(a)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,H=["/app/app/request/submit-request/page.tsx"],I={require:c,loadChunk:()=>Promise.resolve()},J=new d.AppPageRouteModule({definition:{kind:e.RouteKind.APP_PAGE,page:"/request/submit-request/page",pathname:"/request/submit-request",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:G},distDir:".next",projectDir:""});async function K(a,b,c){var d;let B="/request/submit-request/page";"/index"===B&&(B="/");let F="false",L=(0,h.getRequestMeta)(a,"postponed"),M=(0,h.getRequestMeta)(a,"minimalMode"),N=await J.prepare(a,b,{srcPage:B,multiZoneDraftMode:F});if(!N)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:O,query:P,params:Q,parsedUrl:R,pageIsDynamic:S,buildManifest:T,nextFontManifest:U,reactLoadableManifest:V,serverActionsManifest:W,clientReferenceManifest:X,subresourceIntegrityManifest:Y,prerenderManifest:Z,isDraftMode:$,resolvedPathname:_,revalidateOnlyGenerated:aa,routerServerContext:ab,nextConfig:ac}=N,ad=R.pathname||"/",ae=(0,q.normalizeAppPath)(B),{isOnDemandRevalidate:af}=N,ag=Z.dynamicRoutes[ae],ah=Z.routes[_],ai=!!(ag||ah||Z.routes[ae]),aj=a.headers["user-agent"]||"",ak=(0,t.getBotType)(aj),al=(0,o.isHtmlBotRequest)(a),am=(0,h.getRequestMeta)(a,"isPrefetchRSCRequest")??!!a.headers[s.NEXT_ROUTER_PREFETCH_HEADER],an=(0,h.getRequestMeta)(a,"isRSCRequest")??!!a.headers[s.RSC_HEADER],ao=(0,r.getIsPossibleServerAction)(a),ap=(0,l.checkIsAppPPREnabled)(ac.experimental.ppr)&&(null==(d=Z.routes[ae]??Z.dynamicRoutes[ae])?void 0:d.renderingMode)==="PARTIALLY_STATIC",aq=!1,ar=!1,as=ap?L:void 0,at=ap&&an&&!am,au=(0,h.getRequestMeta)(a,"segmentPrefetchRSCRequest"),av=!aj||(0,o.shouldServeStreamingMetadata)(aj,ac.htmlLimitedBots);al&&ap&&(ai=!1,av=!1);let aw=!0===J.isDev||!ai||"string"==typeof L||at,ax=al&&ap,ay=null;$||!ai||aw||ao||as||at||(ay=_);let az=ay;!az&&J.isDev&&(az=_);let aA={...D,tree:G,pages:H,GlobalError:C(),handler:K,routeModule:J,__next_app__:I};W&&X&&(0,n.setReferenceManifestsSingleton)({page:B,clientReferenceManifest:X,serverActionsManifest:W,serverModuleMap:(0,p.createServerModuleMap)({serverActionsManifest:W})});let aB=a.method||"GET",aC=(0,g.getTracer)(),aD=aC.getActiveScopeSpan();try{let d=async(c,d)=>{let e=new k.NodeNextRequest(a),f=new k.NodeNextResponse(b);return J.render(e,f,d).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=aC.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==i.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${aB} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${aB} ${a.url}`)})},f=async({span:e,postponed:f,fallbackRouteParams:g})=>{let i={query:P,params:Q,page:ae,sharedContext:{buildId:O},serverComponentsHmrCache:(0,h.getRequestMeta)(a,"serverComponentsHmrCache"),fallbackRouteParams:g,renderOpts:{App:()=>null,Document:()=>null,pageConfig:{},ComponentMod:aA,Component:(0,j.T)(aA),params:Q,routeModule:J,page:B,postponed:f,shouldWaitOnAllReady:ax,serveStreamingMetadata:av,supportsDynamicResponse:"string"==typeof f||aw,buildManifest:T,nextFontManifest:U,reactLoadableManifest:V,subresourceIntegrityManifest:Y,serverActionsManifest:W,clientReferenceManifest:X,setIsrStatus:null==ab?void 0:ab.setIsrStatus,dir:J.projectDir,isDraftMode:$,isRevalidate:ai&&!f&&!at,botType:ak,isOnDemandRevalidate:af,isPossibleServerAction:ao,assetPrefix:ac.assetPrefix,nextConfigOutput:ac.output,crossOrigin:ac.crossOrigin,trailingSlash:ac.trailingSlash,previewProps:Z.preview,deploymentId:ac.deploymentId,enableTainting:ac.experimental.taint,htmlLimitedBots:ac.htmlLimitedBots,devtoolSegmentExplorer:ac.experimental.devtoolSegmentExplorer,reactMaxHeadersLength:ac.reactMaxHeadersLength,multiZoneDraftMode:F,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:ac.experimental.cacheLife,basePath:ac.basePath,serverActions:ac.experimental.serverActions,...aq?{nextExport:!0,supportsDynamicResponse:!1,isStaticGeneration:!0,isRevalidate:!0,isDebugDynamicAccesses:aq}:{},experimental:{isRoutePPREnabled:ap,expireTime:ac.expireTime,staleTimes:ac.experimental.staleTimes,dynamicIO:!!ac.experimental.dynamicIO,clientSegmentCache:!!ac.experimental.clientSegmentCache,dynamicOnHover:!!ac.experimental.dynamicOnHover,inlineCss:!!ac.experimental.inlineCss,authInterrupts:!!ac.experimental.authInterrupts,clientTraceMetadata:ac.experimental.clientTraceMetadata||[]},waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:()=>{},onInstrumentationRequestError:(b,c,d)=>J.onRequestError(a,b,d,ab),err:(0,h.getRequestMeta)(a,"invokeError"),dev:J.isDev}},k=await d(e,i),{metadata:l}=k,{cacheControl:m,headers:n={},fetchTags:o}=l;if(o&&(n[x.NEXT_CACHE_TAGS_HEADER]=o),a.fetchMetrics=l.fetchMetrics,ai&&(null==m?void 0:m.revalidate)===0&&!J.isDev&&!ap){let a=l.staticBailoutInfo,b=Object.defineProperty(Error(`Page changed from static to dynamic at runtime ${_}${(null==a?void 0:a.description)?`, reason: ${a.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`),"__NEXT_ERROR_CODE",{value:"E132",enumerable:!1,configurable:!0});if(null==a?void 0:a.stack){let c=a.stack;b.stack=b.message+c.substring(c.indexOf("\n"))}throw b}return{value:{kind:u.CachedRouteKind.APP_PAGE,html:k,headers:n,rscData:l.flightData,postponed:l.postponed,status:l.statusCode,segmentData:l.segmentData},cacheControl:m}},l=async({hasResolved:d,previousCacheEntry:g,isRevalidating:i,span:j})=>{let k,l=!1===J.isDev,n=d||b.writableEnded;if(af&&aa&&!g&&!M)return(null==ab?void 0:ab.render404)?await ab.render404(a,b):(b.statusCode=404,b.end("This page could not be found")),null;if(ag&&(k=(0,v.parseFallbackField)(ag.fallback)),k===v.FallbackMode.PRERENDER&&(0,t.isBot)(aj)&&(k=v.FallbackMode.BLOCKING_STATIC_RENDER),(null==g?void 0:g.isStale)===-1&&(af=!0),af&&(k!==v.FallbackMode.NOT_FOUND||g)&&(k=v.FallbackMode.BLOCKING_STATIC_RENDER),!M&&k!==v.FallbackMode.BLOCKING_STATIC_RENDER&&az&&!n&&!$&&S&&(l||!ah)){let b;if((l||ag)&&k===v.FallbackMode.NOT_FOUND)throw new A.NoFallbackError;if(ap&&!an){if(b=await J.handleResponse({cacheKey:l?ae:null,req:a,nextConfig:ac,routeKind:e.RouteKind.APP_PAGE,isFallback:!0,prerenderManifest:Z,isRoutePPREnabled:ap,responseGenerator:async()=>f({span:j,postponed:void 0,fallbackRouteParams:l||ar?(0,m.u)(ae):null}),waitUntil:c.waitUntil}),null===b)return null;if(b)return delete b.cacheControl,b}}let o=af||i||!as?void 0:as;if(aq&&void 0!==o)return{cacheControl:{revalidate:1,expire:void 0},value:{kind:u.CachedRouteKind.PAGES,html:w.default.fromStatic(""),pageData:{},headers:void 0,status:void 0}};let p=S&&ap&&((0,h.getRequestMeta)(a,"renderFallbackShell")||ar)?(0,m.u)(ad):null;return f({span:j,postponed:o,fallbackRouteParams:p})},n=async d=>{var g,i,j,k,m;let n,o=await J.handleResponse({cacheKey:ay,responseGenerator:a=>l({span:d,...a}),routeKind:e.RouteKind.APP_PAGE,isOnDemandRevalidate:af,isRoutePPREnabled:ap,req:a,nextConfig:ac,prerenderManifest:Z,waitUntil:c.waitUntil});if($&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),J.isDev&&b.setHeader("Cache-Control","no-store, must-revalidate"),!o){if(ay)throw Object.defineProperty(Error("invariant: cache entry required but not generated"),"__NEXT_ERROR_CODE",{value:"E62",enumerable:!1,configurable:!0});return null}if((null==(g=o.value)?void 0:g.kind)!==u.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant app-page handler received invalid cache entry ${null==(j=o.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E707",enumerable:!1,configurable:!0});let p="string"==typeof o.value.postponed;ai&&!at&&(!p||am)&&(M||b.setHeader("x-nextjs-cache",af?"REVALIDATED":o.isMiss?"MISS":o.isStale?"STALE":"HIT"),b.setHeader(s.NEXT_IS_PRERENDER_HEADER,"1"));let{value:q}=o;if(as)n={revalidate:0,expire:void 0};else if(M&&an&&!am&&ap)n={revalidate:0,expire:void 0};else if(!J.isDev)if($)n={revalidate:0,expire:void 0};else if(ai){if(o.cacheControl)if("number"==typeof o.cacheControl.revalidate){if(o.cacheControl.revalidate<1)throw Object.defineProperty(Error(`Invalid revalidate configuration provided: ${o.cacheControl.revalidate} < 1`),"__NEXT_ERROR_CODE",{value:"E22",enumerable:!1,configurable:!0});n={revalidate:o.cacheControl.revalidate,expire:(null==(k=o.cacheControl)?void 0:k.expire)??ac.expireTime}}else n={revalidate:x.CACHE_ONE_YEAR,expire:void 0}}else b.getHeader("Cache-Control")||(n={revalidate:0,expire:void 0});if(o.cacheControl=n,"string"==typeof au&&(null==q?void 0:q.kind)===u.CachedRouteKind.APP_PAGE&&q.segmentData){b.setHeader(s.NEXT_DID_POSTPONE_HEADER,"2");let c=null==(m=q.headers)?void 0:m[x.NEXT_CACHE_TAGS_HEADER];M&&ai&&c&&"string"==typeof c&&b.setHeader(x.NEXT_CACHE_TAGS_HEADER,c);let d=q.segmentData.get(au);return void 0!==d?(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(d),cacheControl:o.cacheControl}):(b.statusCode=204,(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(""),cacheControl:o.cacheControl}))}let r=(0,h.getRequestMeta)(a,"onCacheEntry");if(r&&await r({...o,value:{...o.value,kind:"PAGE"}},{url:(0,h.getRequestMeta)(a,"initURL")}))return null;if(p&&as)throw Object.defineProperty(Error("Invariant: postponed state should not be present on a resume request"),"__NEXT_ERROR_CODE",{value:"E396",enumerable:!1,configurable:!0});if(q.headers){let a={...q.headers};for(let[c,d]of(M&&ai||delete a[x.NEXT_CACHE_TAGS_HEADER],Object.entries(a)))if(void 0!==d)if(Array.isArray(d))for(let a of d)b.appendHeader(c,a);else"number"==typeof d&&(d=d.toString()),b.appendHeader(c,d)}let t=null==(i=q.headers)?void 0:i[x.NEXT_CACHE_TAGS_HEADER];if(M&&ai&&t&&"string"==typeof t&&b.setHeader(x.NEXT_CACHE_TAGS_HEADER,t),!q.status||an&&ap||(b.statusCode=q.status),!M&&q.status&&E.RedirectStatusCode[q.status]&&an&&(b.statusCode=200),p&&b.setHeader(s.NEXT_DID_POSTPONE_HEADER,"1"),an&&!$){if(void 0===q.rscData){if(q.postponed)throw Object.defineProperty(Error("Invariant: Expected postponed to be undefined"),"__NEXT_ERROR_CODE",{value:"E372",enumerable:!1,configurable:!0});return(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:q.html,cacheControl:at?{revalidate:0,expire:void 0}:o.cacheControl})}return(0,z.sendRenderResult)({req:a,res:b,type:"rsc",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:w.default.fromStatic(q.rscData),cacheControl:o.cacheControl})}let v=q.html;if(!p||M)return(0,z.sendRenderResult)({req:a,res:b,type:"html",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:o.cacheControl});if(aq)return v.chain(new ReadableStream({start(a){a.enqueue(y.ENCODED_TAGS.CLOSED.BODY_AND_HTML),a.close()}})),(0,z.sendRenderResult)({req:a,res:b,type:"html",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:{revalidate:0,expire:void 0}});let A=new TransformStream;return v.chain(A.readable),f({span:d,postponed:q.postponed,fallbackRouteParams:null}).then(async a=>{var b,c;if(!a)throw Object.defineProperty(Error("Invariant: expected a result to be returned"),"__NEXT_ERROR_CODE",{value:"E463",enumerable:!1,configurable:!0});if((null==(b=a.value)?void 0:b.kind)!==u.CachedRouteKind.APP_PAGE)throw Object.defineProperty(Error(`Invariant: expected a page response, got ${null==(c=a.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E305",enumerable:!1,configurable:!0});await a.value.html.pipeTo(A.writable)}).catch(a=>{A.writable.abort(a).catch(a=>{console.error("couldn't abort transformer",a)})}),(0,z.sendRenderResult)({req:a,res:b,type:"html",generateEtags:ac.generateEtags,poweredByHeader:ac.poweredByHeader,result:v,cacheControl:{revalidate:0,expire:void 0}})};if(!aD)return await aC.withPropagatedContext(a.headers,()=>aC.trace(i.BaseServerSpan.handleRequest,{spanName:`${aB} ${a.url}`,kind:g.SpanKind.SERVER,attributes:{"http.method":aB,"http.target":a.url}},n));await n(aD)}catch(b){throw aD||await J.onRequestError(a,b,{routerKind:"App Router",routePath:B,routeType:"render",revalidateReason:(0,f.c)({isRevalidate:ai,isOnDemandRevalidate:af})},ab),b}}},74075:a=>{"use strict";a.exports=require("zlib")},79551:a=>{"use strict";a.exports=require("url")},79646:a=>{"use strict";a.exports=require("child_process")},81630:a=>{"use strict";a.exports=require("http")},83997:a=>{"use strict";a.exports=require("tty")},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},91645:a=>{"use strict";a.exports=require("net")},94735:a=>{"use strict";a.exports=require("events")}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[985,911,656,754,909,111,213],()=>b(b.s=63257));module.exports=c})();